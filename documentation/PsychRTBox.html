<h2 id="psychtoolbox-psychhardware">[[Psychtoolbox]] › [[PsychHardware]]</h2>
<p>Driver for the USTC reaction time button box <a href="(RTBox)" class="uri">(RTBox)</a> by Xiangrui Li et<br />
al. varargout = <a href="PsychRTBox" class="uri">PsychRTBox</a>(cmd, varargin);</p>
<p>This driver allows to control most functions of the USTC <a href="RTBox" class="uri">RTBox</a> response<br />
button box. In theory this driver should support boxes up to Box/Firmware<br />
version 5. In practice it has only been tested by the Psychtoolbox<br />
developer up to firmware and box version 1.3, therefore you may encounter<br />
bugs for later versions. The box itself comes bundled with an alternative<br />
driver called “<a href="RTBox" class="uri">RTBox</a>” which is maintained by the developers of the box<br />
hardware itself, in case this driver doesn’t work with your box or<br />
firmware.</p>
<p>The <a href="RTBox" class="uri">RTBox</a> is a USB device which provides 4 response buttons (pushbuttons)<br />
for subject responses and can report any button press- or release by the<br />
subject. Additionally it has an input for reporting of external<br />
electronic trigger signals and a photo-diode input for reporting of<br />
visual stimulus onset. The box uses a built-in high-resolution clock to<br />
timestamp all button- or trigger events, independent of the host<br />
computers clock in order to make it more reliable for response time<br />
measurements than most other response devices. It also buffers all events<br />
internally, so experiment scripts can read back events when it is most<br />
convenient. Timestamps can be either reported in Psychtoolbox standard<br />
<a href="GetSecs" class="uri">GetSecs</a> timebase for direct comparison with timestamps from <a href="GetSecs" class="uri">GetSecs</a>,<br />
<a href="WaitSecs" class="uri">WaitSecs</a>, <a href="KbCheck" class="uri">KbCheck</a> et al., <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) and <a href="PsychPortAudio" class="uri">PsychPortAudio</a>, etc. This<br />
simplifies reaction time calculations. Timestamps can also be reported in<br />
the timebase of the boxe, e.g., time of a button press relative to the<br />
photo-diode light trigger signal or electronic trigger signal, if this is<br />
more convenient for a given experiment setup.</p>
<p>Current versions of the <a href="RTBox" class="uri">RTBox</a> have additional functionality, e.g., more<br />
digital trigger inputs, some sound trigger, and TTL trigger outputs.</p>
<p>See http://lobes.osu.edu/rt-box.php for up to date product information and<br />
additional driver software.</p>
<p>Please note that while the device documentation claims that the external<br />
electronic pulse port is able to receive TTL trigger signals, we couldn’t<br />
verify that this is the case with our test sample of version 1 of the<br />
<a href="RTbox" class="uri">RTbox</a> hardware. While the pulse input port responded to some pulses sent<br />
by one TTL compatible device, it failed to detect the majority of signals<br />
from TTL most other test devices.</p>
<p>This indicates that the pulse port may not be fully TTL compliant and<br />
will need additional tinkering for your setup. However, results with<br />
later versions of the hardware may be different than our experience with<br />
our test sample.</p>
<h1 id="the-following-subcommands-are-currently-suppported">The following subcommands are currently suppported:</h1>
<p>handle = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Open’ [, deviceID] [, skipSync=0]);<br />
– Try to open a connected <a href="RTBox" class="uri">RTBox</a>, return a device handle ‘handle’ to it<br />
on success. The handle can be used in all further subcommands to refer to<br />
the box. By default, all USB ports (or rather USB-Serial ports) are scanned<br />
for a connected <a href="RTBox" class="uri">RTBox</a> and the driver will connect to the first box found.<br />
Alternatively you can specify which box to use via the optional<br />
‘deviceID’ namestring. This can be either the name of a box, or the name<br />
of the USB-Serial port to which the box is connected. This way you can avoid<br />
scanning of all ports and disambiguate in case multiple boxes are<br />
connected to your computer.</p>
<p>Btw., if you only make use of one single <a href="RTBox" class="uri">RTBox</a>, you don’t need to specify<br />
the ‘handle’ parameter to all following subfunctions. Instead you can<br />
specify that parameter as [] or omit it and the driver will use the only<br />
open box connected.</p>
<p>The optional parameter ‘skipSync’, if set to 1, will prevent the open<br />
routine from performing an initial clock synchronization. By default, it<br />
will perform an initial clock synchronization.</p>
<h3 id="after-opening-the-box-you-may-want-to-invoke-this-method">After opening the box, you may want to invoke this method:</h3>
<p>clockRatio = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ClockRatio’ [, handle] [, durationSecs]);<br />
– Perform a clock drift calibration between the computers <a href="GetSecs" class="uri">GetSecs</a> host<br />
clock and the internal clock of the box ‘handle’. Restrict calibration to<br />
a maximum of ‘durationSecs’ (default 60 seconds if omitted). Return the<br />
computed ‘clockRatio’ and use it for all further operations.</p>
<p>Due to manufacturing imperfections and environmental factors, no two<br />
clocks ever run at exactly the same speed. Therefore the computer clock<br />
and box clock will slowly “drift out of sync” under normal conditions,<br />
rendering retrieved event timestamps inaccurate over the course of a long<br />
experiment session. This calibration routine will exercise the clocks and<br />
compute the clock drift due to this speed difference, then use the<br />
computed drift (= clockRatio) to correct all reported timestamps for this<br />
drift, thereby providing the accuracy needed for reaction time studies.</p>
<p>The clockRatio value tells, how many seconds of <a href="GetSecs" class="uri">GetSecs</a> time elapse when<br />
the box clock measures 1 second elapsed time. Ideally this value would be<br />
1, ie. both clocks run at the same speed. A more realistic value would be,<br />
e.g., 1.000009 – The computer clock goes 9 microseconds faster than the<br />
box clock, so the drift will accumulate an error of 9 microseconds for<br />
each elapsed second of your study.</p>
<p>As every calibration, this routine involves some measurement/calibration<br />
error and is therefore not perfect, so even after a successfull<br />
‘ClockRatio’ calibration, timestamps reported during your experiment will<br />
accumulate some error during the course of long experiment sessions.</p>
<h3 id="there-are-multiple-ways-to-handle-this">There are multiple ways to handle this:</h3>
<ol type="a">
<li><p>Use a long calibration time in this function for accurate results, and<br />
a reasonably short experiment duration.</p></li>
<li><p>Repeat this procedure after every large block of trials, ie., every<br />
couple of minutes, e.g., while the subject is allowed to take a break in<br />
a long experiment session.</p></li>
<li><p>Use the <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncClocks’) function after each short block of<br />
trials, or even after each trial, for the highest accuracy.</p></li>
<li><p>Don’t care for clock drift throughout the experiment session, just<br />
collect the event timestamps in box clock format (see the 3rd return<br />
argument of <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘GetSecs’) or the returned timing array of<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxSecs’);) and store them in some array. Remap all timestamps<br />
into the computers <a href="GetSecs" class="uri">GetSecs</a> time at the end of your session via<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxsecsToGetsecs’). This requires a bit more<br />
discipline from you in programming and organizing your data, but it<br />
provides the most accurate timestamps.</p></li>
</ol>
<p>[syncResult, clockRatio] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncClocks’ [, handle]);<br />
– Synchronize or resynchronize the clocks of the host computer and the<br />
box. Return result in ‘syncResult’ and the current clockRatio in<br />
‘clockRatio’. This routine is automatically carried out during invocation<br />
of <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ClockRatio’); but you can repeat the sync procedure<br />
anytime between trials via this subfunction for extra accuracy at the<br />
expense of about 0.5 - 1 second additional time for each invocation. You<br />
would typically execute this function at the start of each large block of<br />
trials, or before start of each trial if you are really picky about<br />
super-exact timing. The syncResult contains three values:</p>
<p>syncResult(1) = Host time <a href="(GetSecs)%20time">(GetSecs</a> at time of clock sync.</p>
<p>syncResult(2) = Box time at time of clock sync.</p>
<p>syncResult(3) = Confidence interval for the accuracy of the sync. This<br />
value (in seconds) provides a reliable upper bound for the possible error<br />
introduced in all reported timestamps from the box. The real error may be<br />
significantly smaller, this is just an upper bound that you can check.<br />
Typical results on a well working system should be in the sub-millisecond<br />
range, e.g., 0.0003 seconds or 0.3 msecs. Typical results on a rather<br />
noisy system would be around 0.001 second or 1 msec. Results worse than 2<br />
msecs indicate some problem with your system setup that should be fixed<br />
before executing any experiment study which involves reaction time<br />
measurements. By default, the sync procedure will abort with an error if<br />
it can’t calibrate to an accuracy with a maximum error of 1.3 msecs within<br />
a duration of 0.5 seconds. You can change these default constraints with<br />
a call to <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncConstraints’).</p>
<p>[oldmaxDurationSecs, oldgoodEnoughSecs, oldrequiredSecs, oldsyncMethod] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncConstraints’[, maxDurationSecs][, goodEnoughSecs][, requiredSecs][, syncMethod]);<br />
– Change the constraints to apply during calls to <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncClocks’);<br />
Optionally return old settings.</p>
<p>‘maxDurationSecs’ limits any call to ‘SyncClocks’ to a duration of at<br />
most the given number of seconds. Calibration aborts after at most that<br />
time, even if unsuccessfull - in that case with an error message. By<br />
default, the duration is limited to 0.5 seconds.<br />
‘goodEnoughSecs’ Calibration will finish before ‘maxDurationSecs’ have<br />
elapsed, if the result is more accurate than an error of at most<br />
‘goodEnoughSecs’. By default, this is set to zero seconds, i.e.,<br />
calibration will always take ‘maxDurationSecs’.<br />
‘requiredSecs’ - The calibration will only use samples with an<br />
uncertainty of at most ‘requiredSecs’. If not even a single sample of the<br />
required precision can be acquired within ‘maxDurationSecs’, the call<br />
will fail with an error, indicating that your system setup doesn’t<br />
provide the required timing precision for your demands. By default, the<br />
minimum required precision is 0.0013 seconds, ie., it will tolerate an<br />
error of at most 1.3 msecs.<br />
‘syncMethod’ - Select the synchronization method to use. Either, method 0<br />
(prewrite sync), or method 1 (postwrite sync), or method 2 (average). If<br />
you want to know the difference between the methods, please consult the<br />
source code of this file and read the code for the subroutine ‘function<br />
syncClocks’. All three methods are robust and accurate within the<br />
returned confidence window, usually better than 1 msec. So far, method 1<br />
seems to get the best results on our test setups, so this is the default<br />
for the current driver release. However, we are still evaluating if<br />
method 0 would be a tiny bit better and worth switching the default to<br />
that.</p>
<p>oldverbose = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Verbosity’ [, handle], verbosity);<br />
– Set level of verbosity for driver: 0 = Shut up. 1 = Report errors<br />
only. 2 = Report warnings as well. 3 = Report additional status info. 4 =<br />
Be very verbose about what is going on. The default setting is 3 –<br />
Report moderate status output.</p>
<p>devinfo = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxInfo’ [, handle] [, newdevinfo]);<br />
– Return a struct ‘devinfo’ with all information about the current<br />
status and parameter settings for <a href="RTBox" class="uri">RTBox</a> ‘handle’. Optionally set a new<br />
struct with updated parameters via ‘newdevinfo’. This function is mostly<br />
useful for debugging and benchmarking the driver itself. Most information<br />
contained in ‘devinfo’ will be useless for your purpose.</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘<a href="Close" class="uri">Close</a>’, handle);<br />
– <a href="Close" class="uri">Close</a> connection to specific box ‘handle’. Release all associated<br />
ressources.</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘CloseAll’);<br />
– <a href="Close" class="uri">Close</a> connections to all attached <a href="RTBox" class="uri">RTBox</a> devices. Reset the <a href="PsychRTBox" class="uri">PsychRTBox</a><br />
driver completely. You’ll usually use this function at the end of your<br />
experiment script to clean up.</p>
<p>oldeventspec = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Enable’ [,handle][, eventspec]);<br />
– Enable specified type of event ‘eventspec’ on box ‘handle’. This<br />
allows to enable detection and reporting of a specific type of event. By<br />
default, only reporting of push-button press is enabled, as this is the<br />
most common use of a response box.</p>
<p>The following names are valid for the name string ‘eventspec’:<br />
‘press’ = Report push-button press. This is the default setting.<br />
‘release’ = Report push-button release.<br />
‘pulse’ = Report electronic trigger events on external input port.<br />
‘light’ = Report reception of light flashes by photo-diode on light port.<br />
‘tr’ = Report reception of scanner trigger “TR” (TTL input from pin 7 of DB-9 port).<br />
‘all’ = Enable all events.</p>
<p>If called without the ‘eventspec’ parameter, the function will return the<br />
names of all currently enabled events.</p>
<p>oldeventspec = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Disable’ [,handle][, eventspec]);<br />
– Disable specified type of event ‘eventspec’ on box ‘handle’. This<br />
allows to disable detection and reporting of a specific type of event. By<br />
default, only reporting of push-button press is enabled, as this is the<br />
most common use of a response box.</p>
<p>See ‘Enable’ call for help on parameters.</p>
<p>Once you have setup and calibrated the box and selected the type of<br />
events to detect and report, you will want to actually retrieve<br />
information about events. For this you use these commands:</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Start’ [, handle] [, dontwaitforstart=0]);<br />
– Start event detection and reporting by the box. The box will start<br />
detecting button and trigger events from here on and record them in the<br />
event buffer.</p>
<p>You will usually call this at the beginning of a response period. By<br />
default, the box has reporting already enabled after ’Open’ing it.</p>
<p>The optional ‘dontwaitforstart’ parameter, if set to 1, will ask the<br />
‘Start’ function to return control as soon as possible, ie., without<br />
waiting for confirmation of the box that event reporting has actually<br />
started. By default, the routine waits for an acknowledgement from the<br />
box, which can take 16 - 30 msecs in some cases.</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Stop’ [, handle]);<br />
– Stop event detection and reporting by the box. The box will ignore<br />
detecting button and trigger events from here on and no longerrecord them<br />
in the event buffer.</p>
<p>You will usually call this at the end of a response period.</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Clear’ [, handle] [, syncClocks=0] [, dontRestart=0]);<br />
– Stop event detection and reporting by the box, clear all recorded<br />
events so far, then restart reporting if it was active before calling<br />
this function.</p>
<p>Instead of calling ‘Start’ and ‘Stop’ to mark the start and end of a<br />
response period in a trial you can also simply use this function at the<br />
beginning of a trial (or its response period) to discard any stale data<br />
from a previous trial (or non-response interval).</p>
<p>You can prevent an automatic restart of event reporting by setting the<br />
optional flag ‘dontRestart’ to a value of 1.</p>
<p>You can ask the box to resynchronize its clock to the host computer clock<br />
by setting the optional flag ‘syncClocks’ to a value of 1. This is the<br />
same as calling <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncClocks’).</p>
<p>[time, event, boxtime] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘GetSecs’ [, handle] [, interTimeout=0.1] [, maxTimeout=interTimeout] [, maxItems=inf]);<br />
– Retrieve recorded events from the box ‘handle’.</p>
<p>By default, as many events are returned as are available within the<br />
test interval, but you can select a specific number of wanted events<br />
by setting the optional parameter ‘maxItems’. If there aren’t any pending<br />
events from the box, by default the driver waits for up to 0.1 seconds<br />
for events to arrive. You can change this ‘interTimeout’ interval via the<br />
positive (non-zero) ‘interTimeout’ parameter. The function will return if<br />
no new events show up within ‘interTimeout’ seconds. If something shows<br />
up, the deadline for return is extended by ‘interTimeout’ seconds. You<br />
can set an absolute upper limit to the response interval via the<br />
‘maxTimeout’ parameter. That defaults to ‘interTimeout’ if omitted.<br />
Please note that after an event is detected by the box, up to 16-32 msecs<br />
can elapse until the event is received by the computer, so you may not<br />
want to set these timeout values too small!</p>
<p>The function will return an array of timestamps in ‘time’, and an array<br />
of corresponding names of the events in ‘event’. E.g., event(1) will<br />
report the identity of the first detected event, e.g., ‘1’ if button 1<br />
was pressed, whereas time(1) will tell you when the event happened, ie.,<br />
when button 1 was pressed. ‘time’ is expressed in host clock time, aka<br />
<a href="GetSecs" class="uri">GetSecs</a>() time. If no events are pending since last invocation of this<br />
function, empty vectors will be returned.</p>
<p>Additionally, the vector ‘boxtime’ contains the same timestamp, but<br />
expressed in box clock time. See below for a use of that.</p>
<h3 id="by-default-the-following-names-are-possible-for-events">By default, the following names are possible for ’event’s:</h3>
<p>‘1’ = 1st button pressed, ‘1up’ = 1st button released.<br />
‘2’ = 2nd button pressed, ‘2up’ = 2nd button released.<br />
‘3’ = 3rd button pressed, ‘3up’ = 3rd button released.<br />
‘4’ = 4th button pressed, ‘4up’ = 4th button released.<br />
‘pulse’ = electronic pulse received on electronic pulse input port.<br />
‘light’ = Light pulse received by photo-diode connected to light input port.<br />
‘tr’ = Scanner trigger “TR” (TTL input from pin 7 of DB-9 port) received.<br />
‘serial’ = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Trigger’) Softwaretrigger signal received on USB-Serial port.</p>
<p>Note: ‘tr’ is only supported on boxes with Firmware version 3.0 or later.</p>
<p>However, you can assign arbitrary names to the buttons and events if you<br />
don’t like this nomenclature via the <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ButtonNames’) command.</p>
<p>The reported timestamps are expressed in host clock time, ie., in the<br />
same units as the timestamps returned by <a href="GetSecs" class="uri">GetSecs</a>, <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’),<br />
<a href="PsychPortAudio" class="uri">PsychPortAudio</a>, <a href="KbCheck" class="uri">KbCheck</a>, <a href="KbWait" class="uri">KbWait</a>, etc., so you can directly calculate<br />
reaction times to auditory stimuli, visual stimuli and other events.</p>
<p>See the help for <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SyncClocks’) and <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ClockRatio’)<br />
for the accuracy of these timestamps and tips for obtaining optimal<br />
accuracy.</p>
<p>Additionally the event times are also returned in ‘boxtime’, but this<br />
time expressed in box time – the time of the box internal clock.</p>
<p>There are multiple variants of this query command with the same optional<br />
input arguments, but different return arguments. All of these return<br />
timestamps in box time without remapping to <a href="GetSecs" class="uri">GetSecs</a> time by calling:</p>
<p>[boxtime, event] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxSecs’ …);<br />
– Timestamps are in raw box clock time, everything else is the same as<br />
in <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘GetSecs’ …).</p>
<p>If you have the ‘boxtime’ timestamps from one of the previous functions<br />
around, you can map them later to <a href="GetSecs" class="uri">GetSecs</a> time with very high precision<br />
at the end of your experiment session via:</p>
<p>[<a href="GetSecs" class="uri">GetSecs</a>, Stddev] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxsecsToGetsecs’ [, handle], boxTimes);<br />
– Perform a post-hoc mapping of a vector of raw box timestamps<br />
‘boxTimes’ into a vector of host clock ‘GetSecs’ timestamps. Return some<br />
error measure in ‘Stddev’ as well, if available.</p>
<p>This method can be used to convert event timestamps expressed in the box<br />
clocks timebase into timestamps in Psychtoolbox <a href="GetSecs" class="uri">GetSecs</a> host clock<br />
timebase. It has the advantage of providing the highest possible accuracy<br />
in mapping, because it computes an optimal mapping function for this<br />
purpose, which is based on all the timing information collected<br />
throughout a whole experiment session. The disadvantage is that it will<br />
only provide meaningful results if you call it at the end of your<br />
experiment session, so you’ll need to manage all your collected<br />
timestamps in a format that is suitable as input to this function.</p>
<p>Timestamps can also be returned relative to a specific trigger event: You<br />
specify which event acts as a trigger. Then all timestamps of all events<br />
are expressed relative to the time of that trigger event, i.e., as<br />
deltas. Any event can be the trigger. Format of all arguments is<br />
as in <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘BoxSecs’ …);</p>
<p>E.g., <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘serial’, …); Returns timestamps relative to the first<br />
occurence of a electronic input port trigger signal since the last query.<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘light’, …); Returns timestamps relative to photo-diode<br />
light pulse. <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘1’); returns relative to press of 1st button,<br />
etc. etc.</p>
<p>sendTime = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘SerialTrigger’ [, handle]);<br />
– Send a software generated trigger to the box via the serial port<br />
connection. This will register as a event of type ‘serial’ and you can<br />
retrieve timestamps relative to the first trigger within a response<br />
period via the <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘serial’, …); command.</p>
<p>sendTime = <a href="PsychRTBox" class="uri">PsychRTBox</a>(’EngageLightTrigger [, handle]);<br />
sendTime = <a href="PsychRTBox" class="uri">PsychRTBox</a>(’EngagePulseTrigger [, handle]);<br />
sendTime = <a href="PsychRTBox" class="uri">PsychRTBox</a>(’EngageTRTrigger [, handle]);</p>
<p>– Engage trigger input on the box for reception of a one-shot trigger<br />
signal. This function will return immediately after submitting the<br />
request to the box. It may take up to 5 msecs worst-case until the<br />
trigger input is really enabled. If you want to wait for the trigger to<br />
be really enabled, call, e.g., <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Enable’, handle, ‘lighton’); instead,<br />
as that function will wait until the trigger is really active.</p>
<p>Trigger events are special: If a trigger has been received, the<br />
box auto-disables the trigger input, preventing reception of any<br />
further trigger events, until the trigger gets reenabled. The trigger gets<br />
reenabled on many occasions if it has been enabled once via the<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Enable’, …); command, e.g., at each call to<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Start’); or <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Clear’). If you want to enable the<br />
trigger on-the-fly, then this function is your friend.</p>
<p>The reason why light trigger auto-disables itself is because a typical<br />
CRT display monitor would generate such trigger signals at the rate of<br />
video refresh, once your stimulus is displayed, e.g., at a rate of 100<br />
Hz. Usually you only want to know one defined timestamp of initial<br />
stimulus onset, therefore the box prevents reception of all but the<br />
first light trigger.</p>
<p>Similar reasoning applies to Pulse and TR triggers.</p>
<p>oldNames = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ButtonNames’ [, handle] [, newNames]);<br />
– Query or assign labels for the four response box buttons other than<br />
the default names.</p>
<p>This function allows to assign arbitrary names to the four buttons on the<br />
box. These names are reported when querying for button presses and<br />
releases. By default, oldNames = <a href="PychRTBox" class="uri">PychRTBox</a>(‘ButtonNames’) would return<br />
the cell array with the four following names: ‘1’, ‘2’, ‘3’, ‘4’. These<br />
are the names reported for button presses. Button releases would report<br />
the names with an ‘up’ appended, ie., ‘1up’, ‘2up’, ‘3up’, ‘4up’. You can<br />
assign arbitrary new names by passing a cell array with four namestrings,<br />
e.g., <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ButtonNames’, [], {‘7’, ‘whats’, ‘hick’, ‘screw’})<br />
would assign the names ‘7’, ‘whats’, ‘hick’ and ‘screw’ for button press<br />
events, and ‘7up’, ‘whatsup’, ‘hickup’ and ‘screwup’ for release events<br />
of the corresponding buttons.</p>
<p>Please note that the assignment of names to buttons must be unique, ie.<br />
assigning the same name to multiple buttons is not allowed.</p>
<p>oldIntervals = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘DebounceInterval’ [, handle] [, debounceSecs]);<br />
– Query current button debounce intervals (in 4-element vector<br />
‘oldIntervals’, one value for each button), and optionally set new<br />
debounce interval in seonds via the optional argument ‘debounceSecs’.<br />
‘debounceSecs’ can be a scalar, in which case the same setting is applied<br />
to all buttons, or a 4-element row vector, e.g., [0.1, 0.1, 0.1, 0.1] to<br />
set an individual interval for each of the four buttons.</p>
<p>The built-in debouncer prevents multiple button responses (button press<br />
or release actions) from getting recorded/reported within some<br />
‘debounceSecs’ debounce interval. After a button has changed state, only<br />
the type (press or release), identity (which button) and timestamp (when)<br />
of the first state change is reported. Any other state change within<br />
‘debounceSecs’ seconds of time after that first change will be ignored.<br />
After that time has elapsed, further state changes are reported again. By<br />
default, this dead “debounce” interval is set to 0.050 seconds, ie., 50<br />
msecs. Button bouncing happens if a subject presses or releases a button<br />
very rapidly or vigorously. If such quick multiple events or bounces are<br />
not ignored, they will create multiple apparent button responses which<br />
are a hazzle to deal with in experiment scripts and data analysis.</p>
<p>If you find multiple responses generated for only one apparent button<br />
press during piloting, you may want to set a bigger debounce interval<br />
with this function.</p>
<p>Please note that debouncing doesn’t apply to the <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ButtonDown’)<br />
function.</p>
<p>Please also note that there is another hardware debouncer with a duration<br />
of 0.3 msecs on <a href="RTBox" class="uri">RTBox</a> versions with firmware versions 1.3 and older, which<br />
can’t be disabled, so even if you’d set a zero interval here, you’d still<br />
get a minimum 0.3 msecs debounce period from the hardware itself.</p>
<p>Later versions of the firmware support the following<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘HardwareDebounce’) command to control the hardware debounce<br />
interval more fine-grained.</p>
<p>[oldValue] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘HardwareDebounce’ [, handle] [, scanNum]);<br />
– Set/get hardware debouncer setting. The hardware will treat a button<br />
event as valid only if the button state stays stable for at least<br />
‘scanNum’ scanning iterations of the firmware. The scan interval is about<br />
67 microseconds. The valid scanNum is from 1 through 255, with a default<br />
setting of 16 cycles for 1.072 msecs debounce interval.</p>
<p>For software debouncing at the driver level, see <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘DebounceInterval’)<br />
above.</p>
<p>buttonState = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘ButtonDown’ [, handle] [, whichButtons]);<br />
– This reports the current button state of all response buttons of box<br />
‘handle’, or a subset of response buttons if specified by the optional<br />
‘whichButtons’ argument, e.g., whichButton = {‘1’, ‘4’} to only test<br />
buttons 1 and 4. ‘buttonState’ is a vector which contains a 1 for each<br />
pressed button, and a zero for each released button.</p>
<p>This query is as instantaneous and “live” as possible. The reported state<br />
is not subject to button debouncing, but the measured “raw state”.<br />
Usually you will want to use the <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘GetSecs’ …) functions ans<br />
similar functions to query timestamped button state. They are typically<br />
as fast as this method and they provide timestamps of when the state was<br />
queried, whereas this function doesn’t give you information about how<br />
“fresh” or recent the query is. However for simple button queries outside<br />
the response interval, e.g., while the box is <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘Stop’)’ped with<br />
no need for timestamps, this may be an option.</p>
<p>Due to the design of the USB bus, the query may be outdated wrt. to the<br />
real state by up to 16 - 21 msecs, depending on operating system and<br />
driver configuration.</p>
<p>buttonState = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘WaitButtonDown’ [, handle] [, whichButtons]);<br />
– Wait until at least one of the specified buttons in ‘whichButtons’ is<br />
pressed down. If ‘whichButtons’ is omitted, all buttons are tested.</p>
<p><a href="PsychRTBox" class="uri">PsychRTBox</a>(‘WaitButtonUp’ [, handle] [, whichButtons]);<br />
– Wait until all of the specified buttons in ‘whichButtons’ are<br />
released. If ‘whichButtons’ is omitted, all buttons are tested.</p>
<p>[timeSent, confidence] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘TTL’ [, handle] [, eventCode=1]);<br />
- Send TTL to DB-25 port (pin 8 is bit 0). The second input is event code<br />
(default 1 if omitted), 4-bit (0~15) for box versions &lt; 5, and 8-bit<br />
(0~255) for later versions. It can also be equivalent binary string, such<br />
as ‘0011’.</p>
<p>The optional return arguments are the ‘timeSent’ when the TTL update was<br />
performed, and an upper bound on the uncertainty ‘confidence’ of<br />
‘timeSent’.</p>
<p>The width (duration) of the TTL pulse is controlled by the<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘TTLWidth’) command.</p>
<p>This function is only supported for v3.0 <a href="RTBoxes" class="uri">RTBoxes</a> and later, the ones with<br />
EEG event code support.</p>
<p>[oldValue] = <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘TTLWidth’ [, handle][, widthSecs]);<br />
- Set/get TTL pulse width in seconds. The default width is 0.97e-3, ie.<br />
97 microseconds when the device is opened. The actual width may have some<br />
small variation. The supported width ranges from 0.14e-3 to 35e-3 secs. A<br />
infinite width ‘inf’ is also supported. Infinite width means the TTL will<br />
stay until it is changed by the next <a href="PsychRTBox" class="uri">PsychRTBox</a>(‘TTL’) command, such as<br />
<a href="PsychRTBox" class="uri">PsychRTBox</a>(‘TTL’,0).</p>
<p>This function is only supported for v3.0 <a href="RTBoxes" class="uri">RTBoxes</a> and later, the ones with<br />
EEG event code port support.</p>
<p>In Version &lt;5.0, the TTL width at DB-25 pins 17~24 is controlled by a<br />
potentiometer inside the box. In Version &gt;= 5, the width is also<br />
controlled by ‘TTLWidth’ command.</p>
<p>[oldValue] = <a href="RTBox" class="uri">RTBox</a>(‘TTLResting’ [, handle][, newLevel]);<br />
- Set/get TTL polarity for DB-25 pins 1~8. The default is 0, meaning the<br />
TTL resting is low. If you set newLevel to nonzero, the resting TTL will<br />
be high level. If you need different polarity for different pins, let us<br />
know. This function is only supported with firmware version 3.1 and<br />
later.</p>
<p>In Version 5.0 and later, newLevel has second value, which is the<br />
polarity for pins 17~24.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychHardware/PsychRTBox.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychHardware/PsychRTBox.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychHardware/PsychRTBox.m</code></p>
</div>
