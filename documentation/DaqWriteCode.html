<h2 id="psychtoolbox-psychhardware-daq">[[Psychtoolbox]] › [[PsychHardware]] › [[Daq]]</h2>
<p>err=<a href="DaqWriteCode" class="uri">DaqWriteCode</a><a href="(DeviceIndex),address,data">(DeviceIndex</a><br />
USB-1208FS: Write program memory. This command writes to the program<br />
memory in the device. This command is not accepted unless the device is<br />
in update mode (see <a href="PrepareDownload">PrepareDownload)</a>). The <a href="WriteCode" class="uri">WriteCode</a> command will<br />
normally be used when downloading a new hex file, so it supports the<br />
memory ranges that may be found in the hex file.<br />
The address ranges are:<br />
0x000000 - 0x007AFF: FLASH program memory<br />
0x200000 - 0x200007: ID memory (serial number is stored here)<br />
0x300000 - 0x30000F: CONFIG memory (processor configuration data)<br />
0xF00000 - 0xF03FFF: EEPROM memory<br />
When writing to FLASH program memory, length(data) must be 32 and the<br />
device must receive data in successive 32-byte chunks starting on a<br />
64-byte boundary. When writing to other kinds of memory, length(data) can<br />
be any number of bytes up to the maximum (32).<br />
“<a href="DeviceIndex" class="uri">DeviceIndex</a>” is a small integer, the array index specifying which HID<br />
device in the array returned by <a href="PsychHID" class="uri">PsychHID</a>(‘Devices’) is interface 0<br />
of the desired USB-1208FS box.<br />
“address” is the 24-bit start address for the write.<br />
“data” is a vector with length up to 32, one element per byte.<br />
See also Daq, <a href="DaqFunctions" class="uri">DaqFunctions</a>, <a href="DaqPins" class="uri">DaqPins</a>, <a href="DaqTest" class="uri">DaqTest</a>, <a href="PsychHIDTest" class="uri">PsychHIDTest</a>.</p>
<p>4/15/05 dgp Wrote it.<br />
12/2x/07 mpr tested it and found it wanting<br />
1/11/08 mpr swept through attempting to improve consistency across<br />
daq functions</p>
<p>I have no current plans to make sure this code works, but on 1/8/08 I<br />
discovered it might work as is… According to a comment in the source files<br />
written by the linux people, this function doesn’t actually cause the program<br />
memory to be written. It puts an image of the code in external SRAM, and a<br />
subsequent call to <a href="UpdateCode" class="uri">UpdateCode</a> must be made to write the program into the<br />
device’s flash memory. The command code for the <a href="UpdateCode" class="uri">UpdateCode</a> command is 84,<br />
which Denis did not list for the 1208FS. I have not looked to see if that is<br />
a difference between the 1208 and 1608 or if this was just something Denis<br />
never discovered because he didn’t look for it. Anyways, I have no current<br />
plans to create a <a href="PsychHID" class="uri">PsychHID</a> wrapper for the <a href="UpdateCode" class="uri">UpdateCode</a> command, so if this<br />
functionality is something you want, then that’s what you’ll probably need to<br />
do to get things working. And if you do that, you probably want to invest<br />
some time in figuring out the <a href="ReadChecksum" class="uri">ReadChecksum</a> (command code 82) for verification<br />
that program memory is correct. – mpr</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychHardware/Daq/DaqWriteCode.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychHardware/Daq/DaqWriteCode.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychHardware/Daq/DaqWriteCode.m</code></p>
</div>
