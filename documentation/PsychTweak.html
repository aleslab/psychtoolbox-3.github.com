<h2 id="psychtoolbox-psychbasic">[[Psychtoolbox]] › [[PsychBasic]]</h2>
<p><a href="PsychTweak" class="uri">PsychTweak</a>() - Apply tweaks to various Psychtoolbox parameters.</p>
<p>This function allows to tweak some low-level operating parameters of<br />
Psychtoolbox. Such tweaks often affect all mex files, not only specific<br />
files. You must execute this function before any other Psychtoolbox mex<br />
file is used, otherwise mex files will not pick up consistent settings<br />
and weird things may happen! If in doubt, execute “clear mex” before<br />
executing this function.</p>
<p>Currently the function mostly implements tweaks for MS-Windows to allow<br />
to cope with the brokeness of the system, especially in the domain of<br />
timing and timestamping.</p>
<h1 id="available-subfunctions">Available subfunctions:</h1>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘Reset’);</p>
<p>– Reset some, but not all, tweaks to defaults.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘PrepareForVirtualMachine’);</p>
<p>– Tweak some settings so Psychtoolbox can sort of run inside a Virtual<br />
Machine - or at least limp along in a way that is unsuitable for<br />
production use, but good enough for some basic testing &amp; development of<br />
the toolbox itself, or maybe for some simple demos.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘ScreenVerbosity’, verbosity);</p>
<p>– Set initial level of verbosity for <a href="Screen" class="uri">Screen</a>(). This can be overriden via<br />
<a href="Screen" class="uri">Screen</a>(‘<a href="Preference" class="uri">Preference</a>’,‘Verbosity’). The default verbosity is 3 = Errors,<br />
Warnings and some Info output.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘UseGPUIndex’, gpuidx);<br />
– Use GPU with index ‘gpuidx’ for low-level access on Linux and OSX,<br />
instead of the automatically chosen GPU. This only works on multi-gpu<br />
systems. Hybrid-Graphics <a href="MacBookPro" class="uri">MacBookPro</a> laptops are automatically handled,<br />
so there shouldn’t be any need for this manual selection. The manual<br />
selection is needed in classic multi-gpu systems, e.g., <a href="MacPros" class="uri">MacPros</a> or<br />
PC workstations with multiple powerful <a href="GPUs" class="uri">GPUs</a> installed. On such systems,<br />
normally the first GPU (index 0) would always be used. This command<br />
allows to override that choice.</p>
<h1 id="debugging-of-gstreamergstreamergstreamer-based-functions">Debugging of [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) based functions</h1>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘GStreamerDebug’, debugconfig);</p>
<p>– Select level of verbosity for [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) low-level debug output.<br />
See <a href="http://docs.gstreamer.com/display/%5BGstSDK%5D(GstSDK)/Basic+tutorial+11%3A+Debugging+tools\">http://docs.gstreamer.com/display/[GstSDK](GstSDK)/Basic+tutorial+11%3A+Debugging+tools\</a><br />
for explanation of debug options.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘GStreamerDumpFilterGraph’, targetDirectory);</p>
<p>– <a href="Ask" class="uri">Ask</a> [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) to dump a snapshot of its current media processing<br />
pipeline into a .dot file at each important pipeline state change. These<br />
.dot files can be read by open-source tools like <a href="GraphViz" class="uri">GraphViz</a> and turned into<br />
visualizations of the complete structure and state of the media<br />
processing pipeline. <code>targetDirectory</code> must be the full path to an<br />
existing directory where the .dot files should be written to.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘GStreamerPlaybackThreadingMethod’, methodId);<br />
– <a href="Ask" class="uri">Ask</a> [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) to use multi-threaded video decoding method ‘methodId’<br />
for video playback if multi-threaded video decoding is requested by<br />
user-code. Only some codecs support this. Currently available values are:<br />
1 = Frame-Threading, 2 = Slice-Threading, 3 = 2+1 = Frame and Slice<br />
threading. By default, Frame+Slice threading will be used.</p>
<h1 id="debugging-of-usb-based-functions">Debugging of USB based functions</h1>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘LibUSBDebug’, verbosity);</p>
<p>– Select level of verbosity for low-level debug output of USB functions.<br />
This currently sets the debug level of libusb-1.0 based functions, e.g,<br />
<a href="PsychHID" class="uri">PsychHID</a>, <a href="PsychKinectCore" class="uri">PsychKinectCore</a>, some videocapture functions and others.<br />
Possible values: 0 = Silence (default), 1 = Errors, 2 = Errors +<br />
Warnings, 3 = Errors + Warnings + Info messages.</p>
<h1 id="ms-windows-only-tweaks">MS-Windows only tweaks</h1>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘BackwardTimejumpTolerance’, secs);</p>
<p>– Allow system clock to report a time that is up to <code>secs</code> in the past,<br />
ie., for time to jump backwards, without triggering any clock error<br />
handling. Some broken or deficient computer hardware shows this<br />
misbehaviour and MS-Windows can’t cope with it. Normally PTB would<br />
trigger workarounds and error handling, but a small amount of this error<br />
apparently must be tolerated even on the latest generation of processor<br />
hardware to make some systems workable at all under MS-Windows.</p>
<p>By default, PTB tolerates up to 100 nanoseconds aka 1e-7 secs of error.</p>
<p>Some Intel Core i5 / i7 cpu’s have been reported to exhibit errors of<br />
multiple microseconds, sometimes up to even over 10 microseconds!</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘ForwardTimejumpTolerance’, secs);</p>
<p>– Allow system clock to report a time that is up to <code>secs</code> in the future,<br />
ie., for time to jump forward, without triggering any clock error<br />
handling. Some broken or deficient computer hardware shows this<br />
misbehaviour and MS-Windows can’t cope with it. Normally PTB would<br />
trigger workarounds and error handling, but a small amount of this error<br />
apparently must be tolerated even on the latest generation of processor<br />
hardware to make some systems workable at all under MS-Windows.</p>
<p>By default, PTB tolerates up to 250 msecs aka 0.25 secs of error, not<br />
because we expect such large errors on a well working system, but because<br />
the detection logic needs to allow some room for fuzzyness to avoid false<br />
alerts on heavily loaded systems.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘ExecuteOnCPUCores’, corelist);</p>
<p>– Restrict execution of timing sensitive Psychtoolbox processing threads<br />
to a subset of logical processor cores on a multi-core / multi-processor<br />
computer. This allows to workaround some bugs in timing hardware, but can<br />
seriously degrade performance and general timing behaviour of<br />
Psychtoolbox under more demanding workloads, so this may either help or<br />
hurt, depending on the system setup and application.<br />
<code>corelist</code> must be a vector with the numbers of cores that PTB threads<br />
are allowed to execute on, numbering starts with zero, ie., the 1st<br />
processor core has the number zero.</p>
<p>By default, PTB does not restrict threads on Windows Vista and later, or<br />
on other operating systems than Windows, but restricts all threads to<br />
core zero on Windows XP. The most meaningful use of this parameter is to<br />
either restrict processing to core zero for Windows Vista and later if<br />
you know that this helps, or to allow threads on <a href="WindowsXP" class="uri">WindowsXP</a> to execute on<br />
all available cores if you know that your system configuration is not<br />
susceptible to timing bugs in multi-core mode. PTB will normally<br />
automatically switch to single-core operation on any OS if timing bugs<br />
are detected – it tries to fix itself.</p>
<p><a href="PsychTweak" class="uri">PsychTweak</a>(‘ClockWorkarounds’ [, warning = 1][, lockCores = 1][, lowres = 0][, abort = 0][, defaultlowres = 0]);</p>
<p>– Define how PTB should behave if it detects clock problems due to<br />
broken or misconfigured hardware. All flags are boolean with 1 = enable,<br />
0 = disable, and all flags are optional with reasonable default settings.</p>
<p><code>warning</code>: 1 = Print critical warning messages to the command window to<br />
warn user about potentially broken timing in its scripts.<br />
This setting is on by default.</p>
<p><code>lockCores</code>: 1 = On first signs of trouble, switch to single processor<br />
operation, locking all processing threads to cpu core zero, then<br />
continue. Many multi-processor related clock bugs can be “fixed” this<br />
way, but performance and execution timing may be seriously impaired if<br />
all threads have to compete for computation time on one single processor<br />
core, while all other cores on a multi-core machine are essentially<br />
unused and idle. See help for <code>[ExecuteOnCPUCores](ExecuteOnCPUCores)</code> for more explanation.<br />
This setting is on by default.</p>
<p><code>lowres</code>: 1 = Switch to a low-resolution backup timer if the <code>lockCores</code><br />
workaround is disabled or proven ineffective to solve the problem. The<br />
lowres timer has only +/- 1 msec resolution and this workaround may only<br />
allow you to continue with very simple experiment scripts. Experiment<br />
scripts involving sound via <a href="PsychPortAudio" class="uri">PsychPortAudio</a> + ASIO sound hardware,<br />
Videocapture or Videorecording, and other types of hardware input/output<br />
may fail in weird ways. Even for simple scripts, this may create new<br />
weird timing related problems.<br />
This setting is off by default due to the trouble it can cause.</p>
<p><code>abort</code>: 1 = Abort userscript / session if clock problems can’t be fixed<br />
/ worked around sufficiently well via the <code>lockCores</code> workaround, ie., if<br />
after enabling the workaround a successive clock error gets detected.<br />
This setting is off by default.</p>
<p><code>defaultlowres</code>: 1 = Use low-res backup timer by default, ignore the<br />
high-precision clock. This may help a script on a broken system to limp<br />
along, but is not recommended for production use, because it has the same<br />
problems as the <code>lowres</code> workaround.<br />
This setting is off by default.</p>
<p>History:<br />
9.07.2012 mk Wrote it.<br />
31.08.2014 mk Remove ‘DisableCVDisplayLink’ option, <a href="CVDisplayLinks" class="uri">CVDisplayLinks</a><br />
are off by default as of PTB 3.0.12 and must be enabled<br />
by selecting a <a href="VBLTimestampingmode" class="uri">VBLTimestampingmode</a> &gt; 0 via <a href="Screen" class="uri">Screen</a>(‘<a href="Preference" class="uri">Preference</a>’),<br />
as they are way too unreliable and crash prone.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychBasic/PsychTweak.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychBasic/PsychTweak.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychBasic/PsychTweak.m</code></p>
</div>
