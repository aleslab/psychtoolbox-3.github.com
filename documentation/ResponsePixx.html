<h2 id="psychtoolbox-psychhardware-datapixxtoolbox-datapixxbasic">[[Psychtoolbox]] › [[PsychHardware]] › [[DatapixxToolbox]] › [[DatapixxBasic]]</h2>
<p><a href="ResponsePixx" class="uri">ResponsePixx</a> - Control and use the <a href="ResponsePixx" class="uri">ResponsePixx</a> response button box.</p>
<p>This allows to record button events from the <a href="ResponsePixx" class="uri">ResponsePixx</a> response box<br />
device. Start and stop of logging of button responses and control of the<br />
button lights (on/off and intensity) can be done immediately or<br />
synchronized to the operation of the <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) command, ie.,<br />
synchronized to visual stimulus onset.</p>
<p>By default, <a href="ResponsePixx" class="uri">ResponsePixx</a> response boxes with 5 buttons are supported.<br />
Specify the ‘nrButtons’ parameter in the ‘Open’ subfunction if you need a<br />
different button count.</p>
<p>The code can scan the first 16 digital input pins of the Datapixx, i.e.,<br />
nrButtons can be up to 16, e.g., to control self-made response boxes. The<br />
last 8 input pins are not useable for timestamped button queries and are<br />
instead used to drive the button illumination of the <a href="ResponsePixx" class="uri">ResponsePixx</a><br />
devices.</p>
<p>Caution: Avoid intermixing ‘StartNow’/‘StopNow’ commands with<br />
‘StartAtFlip’/‘StopAtFlip’ commands. While this may work, there is some<br />
potential for using it the wrong way and producing very “funny” bugs.</p>
<p>For reaction time measurements wrt. visual stimuli, see the timestamp<br />
logging functions of the <a href="PsychDataPixx" class="uri">PsychDataPixx</a> driver to get timestamps in<br />
Datapixx clock time. You can also calculate RT’s in <a href="GetSecs" class="uri">GetSecs</a> time wrt. the<br />
host clock by using the usual <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) or <a href="PsychPortAudio" class="uri">PsychPortAudio</a> stimulus<br />
onset timestamps, which may be even more convenient. However, if you do<br />
so, make sure that you read and understand the comments about achieving<br />
good precision by correcting for clock drift, both in the help of the<br />
<a href="ResponsePixx" class="uri">ResponsePixx</a> subfunctions and in the help of <a href="PsychDataPixx" class="uri">PsychDataPixx</a>. Specifically<br />
look at <a href="PsychDataPixx" class="uri">PsychDataPixx</a>(‘GetPreciseTime’) and<br />
<a href="PsychDataPixx" class="uri">PsychDataPixx</a>(‘BoxsecsToGetsecs’).</p>
<h1 id="button-mapping-on-the-responsepixx-handheld-device">Button mapping on the <a href="ResponsePixx" class="uri">ResponsePixx</a> handheld device</h1>
<p>Buttonvector element [1,2,3,4,5] == [Red, Yellow, Green, Blue, White].</p>
<h1 id="subfunctions-and-their-meaning">Subfunctions and their meaning</h1>
<p><a href="ResponsePixx" class="uri">ResponsePixx</a>(‘Open’ [, numSamples=1000][, bufferBaseAddress=12e6][, nrButtons=5]);<br />
- Open <a href="ResponsePixx" class="uri">ResponsePixx</a> for button response collection. Configures the 24 bit<br />
digital input port of the <a href="DataPixx" class="uri">DataPixx</a> to receive button responses from a<br />
<a href="ResponsePixx" class="uri">ResponsePixx</a> response button box and to drive the button illumination<br />
lights of that box. Enabled button debouncing on the digital inputs.</p>
<p>Optional argument ‘numSamples’ defines the maximum number of button<br />
transitions to log. Defaults to 1000 if omitted. ‘bufferBasAddress’ if<br />
provided is the memory start address of the logging buffer inside the<br />
Datapixx. Defaults to 12e6 if omitted.</p>
<p>Optional argument ‘nrButtons’ defines the number of buttons to query. Can<br />
be up to 16 buttons for the first 16 TTL inputs of the <a href="DataPixx" class="uri">DataPixx</a>, but<br />
defaults to 5 buttons - the maximum number supported by the current<br />
<a href="ResponsePixx" class="uri">ResponsePixx</a> devices.</p>
<p>This function doesn’t start logging of responses. Call the ‘StartNow’ or<br />
‘StartAtFlip’ subfunction for start of response collection. Call<br />
‘StopNow’ or ‘StopAtFlip’ to stop response collection.</p>
<p><a href="ResponsePixx" class="uri">ResponsePixx</a>(‘<a href="Close" class="uri">Close</a>’);<br />
- <a href="Close" class="uri">Close</a> <a href="ResponsePixx" class="uri">ResponsePixx</a> after stopping any running logging operations.<br />
Disable the button lights and reset the digital input port of the<br />
Datapixx.</p>
<p>[startTimeBox, startTimeGetSecs] = <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StartNow’ [, clearLog=0][, buttonLightState][, buttonLightIntensity]);<br />
- Start button response collection immediately (ie., with minimum<br />
possible delay on your system). Set the optional ‘clearLog’ flag to 1 if<br />
all currently stored button responses should be discarded prior to<br />
logging of new responses, e.g., at start of a new trial.</p>
<p>The optional vector ‘buttonLightState’ allows to define the on/off state<br />
of the button illumination, e.g., buttonLightState = [0,1,0,0,1] would<br />
turn on the light inside button 2 and 5 and turn off the lights in<br />
buttons 1, 3 and 4. By default, the state of the button lights is not<br />
changed. The optional value ‘buttonLightIntensity’ in the range 0.0 to<br />
1.0 controls the intensity of the button illumination.</p>
<p>Returns a ‘startTimeBox’ timestamp in Datapixx clock time of when<br />
acquisition actually started. You can also use the 2nd optional return<br />
argument ‘startTimeGetSecs’ to get the same timestamp mapped to<br />
Psychtoolbox <a href="GetSecs" class="uri">GetSecs</a>() time. For a more precise post-hoc mapping to<br />
<a href="GetSecs" class="uri">GetSecs</a> time, you can convert the ‘startTimeBox’ timestamp into<br />
Psychtoolbox <a href="GetSecs" class="uri">GetSecs</a>() time with the proper mapping functions of<br />
<a href="PsychDataPixx" class="uri">PsychDataPixx</a> (see “help <a href="PsychDataPixx" class="uri">PsychDataPixx</a>”).</p>
<p>The function can be called multiple times, while logging is already<br />
started, if you just want to clear the log of stored responses or change<br />
the state of the button lights.</p>
<p><a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StartAtFlip’ [, flipCount=next][, clearLog=0][, buttonLightState][, buttonLightIntensity]);<br />
- Schedule start of response collection synchronized to the visual stimulus<br />
onset of a future <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) or <a href="Screen" class="uri">Screen</a>(‘AsyncFlipBegin’) command.</p>
<p>All parameters are identical to the ones for <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StartNow’,…),<br />
except for the first optional parameter ‘flipCount’. ‘flipCount’ defines<br />
at which <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) acquisition should be started. If omitted or<br />
set to zero or [], acquisition will be started by the next flip command.<br />
Otherwise it will be started by the flip command with the given<br />
‘flipCount’. You can query the current flipCount via <a href="PsychDatapixx" class="uri">PsychDatapixx</a>(‘FlipCount’).</p>
<p>Example: Setting flipCount = <a href="PsychDatapixx" class="uri">PsychDatapixx</a>(‘FlipCount’) + 10; would start<br />
acquisition at the 10’th invocation of a flip command from now.</p>
<p>This function doesn’t return a start timestamp as acquisition will<br />
only happen in the future, so the timestamp is only available in the<br />
future.</p>
<p>[stopTimeBox, stopTimeGetSecs] = <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StopNow’ [, clearLog=0][, buttonLightState][, buttonLightIntensity]);<br />
- Stop button response collection immediately (ie., with minimum<br />
possible delay on your system). See ‘StartNow’ for meaning of optional<br />
arguments.</p>
<p>The function can be called multiple times, while logging is already<br />
stopped, if you just want to clear the log of stored responses or change<br />
the state of the button lights.</p>
<p><a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StopAtFlip’ [, flipCount=next][, clearLog=0][, buttonLightState][, buttonLightIntensity]);<br />
- Schedule stop of response collection synchronized to the visual stimulus<br />
onset of a future <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) or <a href="Screen" class="uri">Screen</a>(‘AsyncFlipBegin’) command.<br />
See ‘StartAtFlip’ for meaning of parameters.</p>
<p>[buttonStates, transitionTimesSecs, underflows] = <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘GetLoggedResponses’ [, numberResponses=current][, blocking=1][, timeout=inf]);<br />
- Try to fetch logged button responses from a running logging<br />
operation. Only call this function after logging has been<br />
started via <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StartNow’) or scheduled for start at a<br />
certain flipCount via <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘StartAtFlip’) and the flip is<br />
imminent, i.e., after the flip command for that flip has been called<br />
already. The function will error-out if you call it too early!</p>
<p>The optional ‘numberResponses’ asks the driver to return exactly<br />
‘numberResponses’ button transitions. By default it will return whatever<br />
is available at time of call. If ‘numberResponses’ is specified, but the<br />
requested amount is not yet available, the optional ‘blocking’ flag will<br />
define behaviour: If set to 1 (default), the driver will wait until the<br />
specified amount becomes available. If set to 0, the driver will return<br />
with empty [] return arguments so you can retry later. If ‘blocking’ is<br />
set, then the driver will wait for at most ‘timeout’ seconds for a<br />
response, then return anyway. By default the timeout is infinite.</p>
<p>‘buttonStates’ is a n-by-5 matrix: The n’th row encodes the button state<br />
after the n’th transition of button state. Each column encodes up/down<br />
state of a button, ie., the j’th column encodes state of the j’th button.<br />
0 = Button released, 1 = Button pressed. A button press followed by a<br />
release would create two rows of button transition, one for the<br />
buttonState after pressing a button, a second one for the state after<br />
releasing the button. The <a href="ResponsePixx" class="uri">ResponsePixx</a> uses a debouncing algorithm to<br />
filter out multiple transitions within a 30 msecs time window.</p>
<p>‘transitionTimesSecs’ is the vector of timestamps in Datapixx clock time<br />
of when the corresponding button state has changed. The i’th element<br />
corresponds to the time when the i’th element in the ‘buttonStates’<br />
vector was logged due to a change in button state at that time. See<br />
“help <a href="PsychDataPixx" class="uri">PsychDataPixx</a>” on how to map these box timestamps to <a href="GetSecs" class="uri">GetSecs</a>()<br />
timestamps if you wish.</p>
<p>‘underflows’ is the number of times the logging buffer underflowed. This<br />
indicated lost or corrupted button events. It should only happen if your<br />
subject pressed more buttons within two calls to ‘GetLoggedResponses’<br />
than the event buffer can hold. The size of the buffer can be selected at<br />
‘Open’ time with the ‘numSamples’ parameter, but it defaults to a<br />
generous 1000 button events.</p>
<p>[buttonStates, boxTimeSecs, getsecsTimeSecs] = <a href="ResponsePixx" class="uri">ResponsePixx</a>(‘GetButtons’);<br />
- Perform immediate query of response box button states. Return current<br />
state in ‘buttonStates’ and corresponding box time and <a href="GetSecs" class="uri">GetSecs</a> time<br />
timestamps of time of query in ‘boxTimeSecs’ and ‘getsecsTimeSecs’.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychHardware/DatapixxToolbox/DatapixxBasic/ResponsePixx.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychHardware/DatapixxToolbox/DatapixxBasic/ResponsePixx.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychHardware/DatapixxToolbox/DatapixxBasic/ResponsePixx.m</code></p>
</div>
