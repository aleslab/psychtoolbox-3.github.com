<h1 id="datapixxsetadcschedule"><a href="Datapixx-SetAdcSchedule">Datapixx(‘SetAdcSchedule’)</a></h1>
<h2 id="psychtoolbox-datapixx.mexdll-subfunction">[[Psychtoolbox]] › [[Datapixx]].{mex*,dll} subfunction</h2>
<p>Configure a schedule for autonomous ADC analog signal acquisition.<br />
-“scheduleOnset” is the desired delay (in double precision seconds) between<br />
schedule initiation, and the first ADC sample acquisition.<br />
-“scheduleRate” is the rate at which the ADC’s acquire successive samples.<br />
scheduleRate has two formats. It can be a single number, or a 2 element array.<br />
If it is a single number, then it specifies integer samples/second. If it is a 2<br />
element array, then the first element specifies the rate, and the second element<br />
specifies the units of the rate.<br />
If units = 1, then the rate is interpreted as integer samples/second.<br />
If units = 2, then the rate is interpreted as integer samples/video frame.<br />
If units = 3, then the rate is interpreted as double precision seconds/sample<br />
(sample period).<br />
Regardless of the actual format chosen, the resulting sample rate cannot exceed<br />
200 kHz.<br />
-“maxScheduleFrames” has two modes, depending on whether the acquisition dataset<br />
has a fixed known length. If the dataset length is known (eg: 100000 samples),<br />
then just pass 100000 to maxScheduleFrames. In this mode, once the ADC<br />
acquisition schedule is started with <a href="StartAdcSchedule" class="uri">StartAdcSchedule</a>, the schedule will<br />
terminate automatically when maxScheduleFrames has been acquired. If the dataset<br />
length is not known in advance, then pass 0 to maxScheduleFrames. In this mode,<br />
the acquisition will continue until the schedule is manually stopped using<br />
<a href="StopAdcSchedule" class="uri">StopAdcSchedule</a>.<br />
-“channelList” is a 2D matrix of the ADC channels which should be saved to the<br />
acquisition buffer, and the differential voltage references which should be used<br />
for each voltage acquired. The first row of the matrix contains 1 or more<br />
integers in the range 0 to <a href="GetAdcNumChannels" class="uri">GetAdcNumChannels</a>-1. This is the list of ADC channels<br />
which will be acquired. The second row of the matrix indicates the differential<br />
voltage references for each acquired channel. The reference is selected using a<br />
code in the range 0-3. Code 0 is used when no differential subtraction is<br />
required during acquisition. All analog inputs are referenced to ground, also<br />
known as single-ended acquisition. Code 1 implements fully differential inputs,<br />
subtracting the adjacent channel’s voltage before acquiring (eg: acquiring ADC0<br />
with code = 1 would subtract the ADC1 voltage from the ADC0 voltage, writing the<br />
result to the acquisition buffer). When using this mode, data is typically<br />
acquired only on the even channels, effectively halving the number of available<br />
channels. Code 2 implements a differential input referenced to the REF0 analog<br />
input (see the Datapixx user manual for pinouts). This has the benefits of<br />
high-impedance differential inputs, without having to sacrifice half of the<br />
channels as with fully differential inputs. Code 3 implements a differential<br />
input referenced to the REF1 analog input. It is possible to use different codes<br />
for different analog channels in a single acquisition schedule. For example ADC0<br />
and ADC1 could be acquired single-ended while ADC2 is referenced to ADC3, and<br />
ADC4/5/6/7 could be referenced to REF0. It is also possible to pass only a<br />
single row of ADC channels to channelList. In this case, all of the ADC channels<br />
will be acquired single-ended.<br />
-“bufferBaseAddress” specifies the start of the RAM buffer which should hold the<br />
acquired data inside the Datapixx. Use <a href="ReadAdcBuffer" class="uri">ReadAdcBuffer</a> to upload the acquired data<br />
from this address after calling <a href="StartAdcSchedule" class="uri">StartAdcSchedule</a>.<br />
-“numBufferFrames” specifies the desired size of the acquisition buffer in the<br />
Datapixx RAM. For many applications, the Datapixx has enough RAM to acquire a<br />
complete dataset without streaming. In these cases, numBufferFrames could be<br />
left at its default value of maxScheduleFrames. The Datapixx typically has 128<br />
MB of internal RAM which is shared between all I/O subsystems (DAC/ADC/AUDIO,<br />
etc). Datapixx(‘GetRamSize’) can be used to query the quantity of RAM in your<br />
system. If maxScheduleFrames is larger than numBufferFrames (or 0), then each<br />
time the acquisition frame counter reaches a multiple of numBufferFrames, the<br />
acquisition buffer address automatically wraps back to bufferBaseAddress. This<br />
circular buffer effect can be used for acquiring arbitrarily long analog<br />
datasets. Simply monitor newBufferFrames returned by <a href="GetAdcStatus" class="uri">GetAdcStatus</a>, and use<br />
<a href="ReadAdcBuffer" class="uri">ReadAdcBuffer</a> in streaming mode to upload newly acquired data from the Datapixx<br />
RAM to the host.<br />
Note that every call to <a href="StartAdcSchedule" class="uri">StartAdcSchedule</a> must be preceeded by a call to<br />
<a href="SetAdcSchedule" class="uri">SetAdcSchedule</a> (ie: multiple calls to <a href="StartAdcSchedule" class="uri">StartAdcSchedule</a> each require their own<br />
call to <a href="SetAdcSchedule">SetAdcSchedule)</a>).<br />
Note that schedule timing is implemented in hardware with microsecond precision.<br />
See <a href="DatapixxAdc" class="uri">DatapixxAdc</a>*Demo files for examples.</p>
<p>&lt;&lt;=====See also:===== StartAdcSchedule, StopAdcSchedule, GetAdcStatus, ReadAdcBuffer &lt;&lt;</p>
