<h1 id="screenasyncflipbegin"><a href="Screen-AsyncFlipBegin">Screen(‘AsyncFlipBegin’)</a></h1>
<h2 id="psychtoolbox-screen.mexdll-subfunction">[[Psychtoolbox]] › [[Screen]].{mex*,dll} subfunction</h2>
<p>Schedule an asynchronous flip of front and back display surfaces for given<br />
onscreen window. “windowPtr” is the id of the onscreen window whose content<br />
should be shown at flip time. “when” is the requested stimulus onset time, a<br />
value of zero or no argument asks for flip at next possible vertical retrace.<br />
For the meaning and explanation of all other parameters, see the help for<br />
‘<a href="Screen" class="uri">Screen</a> <a href="Flip" class="uri">Flip</a>?’.</p>
<p>If this command is called while a previously scheduled asynchronous flip is<br />
still in progress, it will wait for that pending async flip to finish and return<br />
its results (timestamps etc.). If no such operation is in progress, it will<br />
return results of the most recently finished async or sync flip. Waiting for<br />
previous flips to complete and returning their results is a convenience<br />
function. In most cases, in order to have more control over the execution of<br />
your script and your flip timing, you will rather want to use one of the<br />
finalizer commands <a href="Screen" class="uri">Screen</a>(‘AsyncFlipCheckEnd’) or <a href="Screen" class="uri">Screen</a>(‘AsyncFlipEnd’)<br />
mentioned below to collect information about the final result and timing of the<br />
asynchronous flip operation.</p>
<p>The difference between <a href="Screen" class="uri">Screen</a>(‘AsyncFlipBegin’,…); and the more commonly used<br />
<a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’, …); is that <a href="Screen" class="uri">Screen</a>(‘<a href="Flip" class="uri">Flip</a>’) operates synchronously: Execution of<br />
your code is paused until the flip operation has finished, ie. at least until<br />
the requested onset deadline ‘when’ has passed.</p>
<p><a href="Screen" class="uri">Screen</a>(‘AsyncFlipBegin’) will prepare everything for a flip at the requested<br />
time ‘when’ - or at next vertical retrace if ‘when’ is omitted - but then<br />
immediately return control to your code. Your code can continue to execute and<br />
do other things, e.g., schedule flips for other onscreen windows, perform<br />
keyboard or mouse queries, etc.</p>
<p>You can check the progress state of asynchronous flips or wait for them to<br />
finish and collect timing information for the finalized flip by use of the<br />
commands <a href="Screen" class="uri">Screen</a>(‘AsyncFlipCheckEnd’) and <a href="Screen" class="uri">Screen</a>(‘AsyncFlipEnd’);</p>
<p>In general you should avoid using asynchronous flips and instead use<br />
conventional ‘<a href="Flip" class="uri">Flip</a>’ unless you have a good reason to do otherwise, because async<br />
flips come with a couple of strings attached:</p>
<ul>
<li><p>You are restricted in what you can do with <a href="Screen" class="uri">Screen</a>() or <a href="OpenGL" class="uri">OpenGL</a> while async<br />
flips are in progress: You can not do anything with textures or offscreen<br />
windows while their parent-onscreen window is in async flip state. You can<br />
only access onscreen windows which are not participating in an async flip<br />
operation.</p></li>
<li><p>If you enable the Psychtoolbox image processing pipeline, most restrictions<br />
on drawing during async flips are relaxed: You can draw into any windows while<br />
async flips are pending, even the window for which the flip is pending. Only<br />
use of the <a href="Screen" class="uri">Screen</a>(‘GetImage’) command is forbidden on async flipping onscreen<br />
windows and potentially problematic on offscreen windows while an async flip<br />
is in progress. However, this is somewhat theoretical. In practice many<br />
operating systems, graphics drivers and graphics cards can’t really handle the<br />
load of parallel drawing and async flipping, due to system bugs or design<br />
constraints. On such systems you may observe inconsistent timing, degraded<br />
performance, and on some systems even visual stimulus corruption, malfunctions<br />
or hard system crashes [e.g., Apple <a href="MacOS" class="uri">MacOS</a>/X 10.4.11 with ATI Radeon X1600]!</p></li>
<li><p>Even the restricted set of allowed reliably working <a href="Screen" class="uri">Screen</a>/<a href="OpenGL" class="uri">OpenGL</a> commands<br />
should be avoided, because some graphics hardware and drivers may not be<br />
able to handle such concurrent graphics operations without degraded stimulus<br />
onset timing accuracy, ie. you may experience more missed stimulus deadlines<br />
and timing glitches – or inconsistent behaviour accross different computers<br />
and graphics cards or operating system releases. In the end it allows you to<br />
do non-<a href="Screen" class="uri">Screen</a> related things like sound, I/O, keyboard checks…</p></li>
<li><p>Parallel processing of flips puts additional burden onto your CPU,<br />
GPU and operating system, so it incurs additional overhead and may degrade<br />
absolute drawing performance and cause more timing issues and glitches if<br />
your system is not reliably able to handle the concurrent load.</p></li>
<li><p>Code with async flips - as any piece of parallely executing code - is harder<br />
to implement correctly and more challenging to debug for you.</p></li>
<li><p>Using a non-zero “multiflip” argument is not allowed.</p></li>
<li><p>Asynchronous updates of gamma tables will likely not work reliably.</p></li>
<li><p>Stereo stimulus display in stereomode 10 (two separate onscreen windows) will<br />
likely not work with reliable timing or have possible tearing artifacts.</p></li>
<li><p>Use of the ‘UserspaceBufferDrawingPrepare’ hook-chain of the imaging<br />
pipeline is not allowed.</p></li>
</ul>
<p>Our general stance is that most code can be written efficiently without need for<br />
async flips, so this feature is provided for the few demanding special cases<br />
where this is not the case and the benefits outweight the costs.</p>
<p>&lt;&lt;=====See also:===== DrawingFinished WaitUntilAsyncFlipCertain AsyncFlipBegin AsyncFlipCheckEnd AsyncFlipEnd Flip &lt;&lt;</p>
