<h1 id="screencreatemovie"><a href="Screen-CreateMovie">Screen(‘CreateMovie’)</a></h1>
<h2 id="psychtoolbox-screen.mexdll-subfunction">[[Psychtoolbox]] › [[Screen]].{mex*,dll} subfunction</h2>
<p>Create a new movie file with filename ‘movieFile’ and according to given<br />
‘movieOptions’.<br />
The function returns a handle ‘moviePtr’ to the file.<br />
Currently only single-track video encoding is supported.<br />
See ‘<a href="Screen" class="uri">Screen</a> <a href="AddAudioBufferToMovie" class="uri">AddAudioBufferToMovie</a>?’ on how to add audio tracks to movies.</p>
<p>Movie creation is a 3 step procedure:<br />
1. Create a movie and define encoding options via ‘CreateMovie’.<br />
2. Add video and audio data to the movie via calls to ‘AddFrameToMovie’ et<br />
al. 3. Finalize and close the movie via a call to ‘FinalizeMovie’.</p>
<h3 id="all-following-parameters-are-optional-and-have-reasonable-defaults">All following parameters are optional and have reasonable defaults:</h3>
<p>‘width’ Width of movie video frames in pixels. Defaults to width of window<br />
‘windowPtr’.<br />
‘height’ Height of movie video frames in pixels. Defaults to height of window<br />
‘windowPtr’.<br />
‘frameRate’ Playback framerate of movie. Defaults to 30 fps. Technically this is<br />
not the playback framerate but the granularity in 1/frameRate seconds with which<br />
the duration of a single movie frame can be specified. When you call<br />
‘AddFrameToMovie’, there’s an optional parameter ‘frameDuration’ which defaults<br />
to one. The parameter defines the display duration of that frame as the fraction<br />
‘frameDuration’ / ‘frameRate’ seconds, so ‘frameRate’ defines the denominator of<br />
that term. However, for a default ‘frameDuration’ of one, this is equivalent to<br />
the ‘frameRate’ of the movie, at least if you leave everything at defaults.</p>
<p>‘movieoptions’ a textstring which allows to define additional parameters via<br />
keyword=parm pairs. For [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) movie writing, you can provide the same<br />
options as for [<a href="GStreamer" class="uri">GStreamer</a>][(GStreamer)]((GStreamer)) video recording. See ‘help VideoRecording’ for<br />
supported options and tips.<br />
Keywords unknown to a certain implementation or codec will be silently ignored:<br />
<a href="EncodingQuality" class="uri">EncodingQuality</a>=x Set encoding quality to value x, in the range 0.0 for lowest<br />
movie quality to 1.0 for highest quality. Default is 0.5 = normal quality. 1.0<br />
often provides near-lossless encoding.<br />
‘numChannels’ Optional number of image channels to encode: Can be 1, 3 or 4 on<br />
<a href="OpenGL" class="uri">OpenGL</a> graphics hardware, and 3 or 4 on <a href="OpenGL" class="uri">OpenGL</a>-ES hardware. 1 = Red/Grayscale<br />
channel only, 3 = RGB, 4 = RGBA. Please note that not all video codecs can<br />
encode pure 1 channel data or RGBA data, ie. an alpha channel. If an unsuitable<br />
codec is selected, movie writing may fail, or unsupported channels (e.g., the<br />
alpha channel) may get silently discarded. It could also happen that a codec<br />
which doesn’t support 1 channel storage will replicate the Red/Grayscale data<br />
into all three RGB channels, leading to no data loss but increased movie file<br />
size. Default is to request RGBA 4 channel data from the system, encoding to<br />
RGBA or RGB, depending on codec.<br />
‘bitdepth’ Optional color/intensity resolution of each channel: Default is 8<br />
bpc, for 8 bit per component storage. <a href="OpenGL" class="uri">OpenGL</a> graphics hardware, but not<br />
<a href="OpenGL" class="uri">OpenGL</a>-ES, also supports 16 bpc image readback. However, not all codecs can<br />
encode with &gt; 8 bpc color/luminance precision, so encoding with 16 bpc may fail<br />
or silently reduce precision to less bits, possibly 8 bpc or less. If you<br />
specify the special keyword <a href="UsePTB16BPC" class="uri">UsePTB16BPC</a> in ‘movieoptions’, then PTB will use its<br />
own proprietary 16 bpc format for 1 or 3 channel mode. This format can only be<br />
read by PTB’s own movie playback functions, not by other software.<br />
In general, embedded <a href="OpenGL" class="uri">OpenGL</a>-ES graphics hardware is more restricted in the type<br />
of image data it can return. Most video codecs are lossy codecs. They will<br />
intentionally throw away color or spatial precision of encoded video to reduce<br />
video file size or network bandwidth, often in a way that is not easily<br />
perceptible to the naked eye. If you require high fidelity, make sure to<br />
double-check your results for a given codec + parameter setup, e.g., via<br />
encoding + decoding the movie and checking the original data against decoded<br />
data.</p>
<p>&lt;&lt;=====See also:===== FinalizeMovie AddFrameToMovie CloseMovie PlayMovie GetMovieImage GetMovieTimeIndex SetMovieTimeIndex &lt;&lt;</p>
