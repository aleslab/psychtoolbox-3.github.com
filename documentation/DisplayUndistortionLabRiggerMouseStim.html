<h2 id="psychtoolbox-psychglimageprocessing">[[Psychtoolbox]] › [[PsychGLImageProcessing]]</h2>
<p>scal = <a href="DisplayUndistortionLabRiggerMouseStim" class="uri">DisplayUndistortionLabRiggerMouseStim</a>(caliboutfilename[, screenid])</p>
<p>Hi-Def TV for mice - Courtesy of Labrigger.</p>
<p>CAUTION: This is not a finished, polished routine, but a template for<br />
actual producers of TV for mice to get started. Make sure you understand<br />
this code before using it!</p>
<p>Geometric display calibration procedure for undistortion of distorted<br />
displays. Needs graphics hardware with basic support for the PTB imaging<br />
pipeline.</p>
<p>This one is an example of how to integrate sample code from <a href="LabRigger" class="uri">LabRigger</a><br />
for visual stimulation of a mouse with a single flat screen. It does the<br />
neccessary undistortion. For explanation and detail go to the original<br />
code and method presented at:</p>
<p>http://labrigger.com/blog/2012/03/06/mouse-visual-stim/comment-page-1/</p>
<p>Please note this is quickly hacked together throwaway sample code. It<br />
almost literally copy and pasted the code from <a href="LabRigger" class="uri">LabRigger</a> into the<br />
subroutine <a href="MouseStim" class="uri">MouseStim</a>() and then converts its output calibration matrices<br />
into a calibration file useable by Psychtoolbox <a href="DisplayUndistortionCSV" class="uri">DisplayUndistortionCSV</a><br />
method, so these undistortions can be applied to live visual stimuli<br />
fast and in realtime. All display and stimulation setup parameters are<br />
hard-coded in <a href="MouseStim" class="uri">MouseStim</a>(). Somebody should really clean up this routine<br />
and test it on a real stimulation setup. If you’ve successfully done so,<br />
please contribute the enhanced version of this M-File back to the PTB<br />
for integration into future releases.</p>
<h3 id="general-boiler-plate-description-of-working-and-use">General boiler-plate description of working and use:</h3>
<p>Psychtoolbox can “undistort” your visual stimuli for you: At stimulus<br />
onset time, PTB applies a geometric warping transformation to your<br />
stimulus which is meant to counteract or cancel out the geometric<br />
distortion caused by your display device. If both, PTB’s warp transform<br />
and the implicit distortion transform of the display match, your stimulus<br />
will show up undistorted on the display device.</p>
<p>For this to work, PTB needs a non-ancient graphics card with support for<br />
the PTB imaging pipeline. All ATI/AMD cards starting with Radeon 9500 and<br />
all <a href="NVidia" class="uri">NVidia</a> cards of type <a href="GeForce" class="uri">GeForce</a>-FX5200 and later, as well as the Intel-GMA 950<br />
and later should be able to do it, although more recent cards will have a higher<br />
performance.</p>
<p><a href="DisplayUndistortionLabRiggerMouseStim" class="uri">DisplayUndistortionLabRiggerMouseStim</a> defines a continous mapping<br />
(x’, y’) = f(x, y) from uncorrected input pixel locations (x,y) in<br />
your stimulus image to output locations (x’, y’) on your display.<br />
This mapping is defined by a linear mesh of quadrilaterals, as computed<br />
in the subfunction <a href="MouseStim" class="uri">MouseStim</a>().</p>
<h1 id="how-to-use">How to use</h1>
<h3 id="execute-the-function-with-the-following-parameters">Execute the function with the following parameters:</h3>
<p><code>caliboutfilename</code> Name of the file to which calibration results should<br />
be stored. If no name is provided, the file will be stored inside the<br />
‘GeometryCalibration’ subfolder of your Psychtoolbox configuration<br />
directory (path is <a href="PsychToolboxConfigDir" class="uri">PsychToolboxConfigDir</a>(‘GeometryCalibration’). The<br />
filename will contain the screenid of the display that was calibrated.</p>
<p><code>screenid</code> screen id of the target display for calibration. The parameter<br />
is optional, defaults to zero, and is only used to generate the default<br />
filename for the output file.</p>
<p>This script will print out a little snippet of code that you can paste<br />
and include into your experiment script - That will automatically load<br />
the calibration result file and apply the proper undistortion operation.</p>
<p>You can see an example use of it in <a href="ImagingVideoCaptureDemo" class="uri">ImagingVideoCaptureDemo</a>.m</p>
<p>A quick way to test your calibration created with this script is to<br />
call <a href="ImageUndistortionDemo" class="uri">ImageUndistortionDemo</a> (caliboutfilename, ‘checkerboard’). However,<br />
for production use you’d rather use your calibration via <a href="PsychImaging" class="uri">PsychImaging</a>,<br />
as shown in <a href="ImagingVideoCaptureDemo" class="uri">ImagingVideoCaptureDemo</a> or the code snippet printed by this<br />
function.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychGLImageProcessing/DisplayUndistortionLabRiggerMouseStim.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychGLImageProcessing/DisplayUndistortionLabRiggerMouseStim.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychGLImageProcessing/DisplayUndistortionLabRiggerMouseStim.m</code></p>
</div>
