<h2 id="psychtoolbox-psychcolorimetric">[[Psychtoolbox]] › [[PsychColorimetric]]</h2>
<p>[M,<a href="LMLumWeights" class="uri">LMLumWeights</a>] = <a href="ComputeDKL" class="uri">ComputeDKL</a>_M(bg,T_cones,T_Y)</p>
<p>Compute the matrix that converts between incremental cone<br />
coordinates and DKL space. The order of<br />
the coordinates in the DKL column vectors is (Lum, RG, S)</p>
<p>The code follows that published by Brainard<br />
as an appendix to Human Color Vision by Kaiser<br />
and Boynton, but has been generalized to work<br />
for passed cone fundamentals and luminosity<br />
function.</p>
<p>These should be passed in standard Psychtoolbox<br />
form (LMS in rows of T_cones; luminosity function<br />
as single row vector T_Y).</p>
<p>The argument bg is the LMS cone coordinates of the<br />
background that defines the space.</p>
<p>See [<a href="DKLDemo" class="uri">DKLDemo</a>][(DKLDemo)]((DKLDemo)) for proper use of this function. Also<br />
<a href="DKLToConeInc" class="uri">DKLToConeInc</a> and <a href="ConeIncToDKL" class="uri">ConeIncToDKL</a>.</p>
<p>8/30/96 dhb Pulled it out.<br />
4/9/05 dhb Allow passing of cones and luminance to be used.<br />
11/17/05 dhb Require passing of cones and luminance.<br />
dhb Fixed definition of M_raw to handle arbitrary L,M scaling.<br />
10/5/12 dhb Comment specifying coordinate system convention. Supress extraneous printout.<br />
04/13/17 dhb Return weights that give luminance from sum of L and M cone excitations.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychColorimetric/ComputeDKL_M.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychColorimetric/ComputeDKL_M.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychColorimetric/ComputeDKL_M.m</code></p>
</div>
