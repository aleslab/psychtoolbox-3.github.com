<h1 id="psychportaudioaddtoschedule"><a href="PsychPortAudio-AddToSchedule">PsychPortAudio(‘AddToSchedule’)</a></h1>
<h2 id="psychtoolbox-psychportaudio.mexdll-subfunction">[[Psychtoolbox]] › [[PsychPortAudio]].{mex*,dll} subfunction</h2>
<p>Add a new item to an existing schedule for audio playback on audio device<br />
‘pahandle’.<br />
The schedule must have been created and enabled already via a previous call to<br />
‘UseSchedule’. The function returns if the addition of a new item was<br />
successfull via the return argument ‘success’ (1=Success, 0=Failed), and the<br />
number of remaining free slots in ‘freeslots’. Failure to add an item can happen<br />
if the schedule is full. If playback is running, you can simply retry after some<br />
time, because eventually the playback will consume and thereby free at least one<br />
slot in the schedule. If playback is stopped and you get this failure, you<br />
should reallocate the schedule with a bigger size via a proper call to<br />
‘UseSchedule’.<br />
Please note that after playback/processing of a schedule has finished by itself,<br />
or due to ‘Stop’ping the playback via the stop function, you should clear or<br />
reactivate the schedule and rewrite it, otherwise results at next call to<br />
’Start’ may be undefined. You can clear/reactivate a schedule efficiently<br />
without resizing it by calling ‘UseSchedule’ with an enableFlag of 2 or 3.</p>
<p>The following optional paramters can be used to define the new slot in the<br />
schedule:<br />
‘bufferHandle’ Handle of the audio buffer which should be used for playback of<br />
this slot. The default value zero will play back the standard audio buffer<br />
created by a call to ‘FillBuffer’.<br />
‘repetitions’ How often should playback of this slot be repeated. Fractional<br />
positive values are allowed, the value zero (ie. infinite repetition) is not<br />
allowed in this driver release.<br />
‘startSample’ and ‘endSample’ define a playback loop - a subsegment of the audio<br />
buffer to which playback should be restricted, and ‘UnitIsSeconds’ tells if the<br />
given loop boundaries are expressed in audio sample frames, or in seconds<br />
realtime. See the help for the ‘SetLoop’ function for more explanation.</p>
<p>‘specialFlags’ is an optional parameter to pass in some special mode flags to<br />
alter processing of a slot: Defaults to zero. If the value ‘1’ is used (or<br />
added), then a slot is not automatically disabled after it has been used up, but<br />
it will be reused on repeated execution of the schedule. You’ll need to set this<br />
flag on all slots in a schedule if you want the schedule to auto-repeat without<br />
the need for manual reset commands.</p>
<p>This function can also be used to sneak special command slots into the schedule:<br />
If you specify a negative number for the ‘bufferHandle’ argument, then this<br />
actually defines a command slot instead of a regular playback slot, and the<br />
number is a command code that defines the action to take. For timing related<br />
actions, the ‘repetitions’ parameter is abused as a ‘tWhen’ time specification<br />
in seconds.<br />
Following command codes are currently defined: (Add numbers to combine options)<br />
1 = Pause audio playback (and capture) immediately, resume it at a given<br />
‘tWhen’ target time.<br />
2 = (Re-)schedule the end of playback for given ‘tWhen’ target time.<br />
You must specify the type of ‘tWhen’ if you specify 1 or 2 as commandCode:+4 =<br />
‘tWhen’ is an absolute <a href="GetSecs" class="uri">GetSecs</a>() style system time.<br />
+8 = ‘tWhen’ is a time delta to the last requested start time of playback.<br />
+16 = ‘tWhen’ is a time delta to the last actual start time of playback.<br />
+32 = ‘tWhen’ is a time delta to the last requested end time of playback. Broken<br />
&amp; Defective!!<br />
+64 = ‘tWhen’ is a time delta to the last actual end time of playback. Broken &amp;<br />
Defective!!</p>
<p>E.g., you want to (re)start playback at a certain time, then you’d set<br />
‘bufferHandle’ to -5, because command code would be 1 + 4 == 5, so negated it is<br />
-5. Then you’d specify the requested time in the ‘repetitions’ parameter as an<br />
absolute time in seconds.</p>
<p>&lt;&lt;=====See also:===== FillBuffer Start Stop RescheduleStart UseSchedule &lt;&lt;</p>
