<h2 id="psychtoolbox-psychopengl-psychglslshaders">[[Psychtoolbox]] › [[PsychOpenGL]] › [[PsychGLSLShaders]]</h2>
<p>[shader configstring] = <a href="EXPCreateStatic2DConvolutionShader" class="uri">EXPCreateStatic2DConvolutionShader</a>(kernel [, nrinputchannels=3][, nroutchannels=3][, debug][, shadertype])</p>
<p>Creates a GLSL fragment shader for 2D convolution of textures with<br />
the 2D or 1D convolution kernel ‘kernel’ and returns a handle ‘shader’<br />
to it, as well as a blitter config options string as needed by the<br />
PTB imaging pipeline.</p>
<p>Usually you won’t call this routine directly, but use<br />
<a href="Add2DConvolutionToGLOperator" class="uri">Add2DConvolutionToGLOperator</a>() instead. It allows convenient setup of<br />
convolution operators of arbitrary size and complexity to <a href="GLOperators" class="uri">GLOperators</a><br />
for use with <a href="Screen" class="uri">Screen</a>(‘TransformTexture’); and for use with the stimulus<br />
post-processing pipeline. Only if you want to create small convolution<br />
kernels for single-pass convolution of textures, you’ll use this routine<br />
directly and use the returned ‘shader’ as argument to <a href="Screen" class="uri">Screen</a>(‘DrawTexture’)<br />
or <a href="Screen" class="uri">Screen</a>(‘MakeTexture’) as ‘textureShader’ argument.</p>
<p>If you call this function directly, the generated shader may only work with<br />
the onscreen window that is active at the time you call the function. To make<br />
sure that the shader works with the onscreen window ‘win’ of your choice, call<br />
<a href="Screen" class="uri">Screen</a>(‘GetWindowInfo’, win); first, to activate the window ‘win’.</p>
<h3 id="parameters">Parameters:</h3>
<p>‘kernel’ is a simple 2D m-by-n matrix of floating point numbers with m and<br />
n being odd numbers, e.g., 1x1, 3x3, 5x5, 7x7, 9x9,…, 1x3, 1x9, 7x1 …<br />
Each entry in the kernel is used as a weight factor.</p>
<p>The simplest way to get a 2D kernel is to use the function<br />
kernel = fspecial(…); fspecial is part of the Matlab image<br />
processing toolbox, see “help fspecial” for more information.</p>
<p>‘nrinputchannels’ = The number of image channels to use as input for the<br />
convolution. Possible values are: 3 = Red, Green and Blue color channels are<br />
provided as part of a true-color image, don’t use the alpha channel (if<br />
any) for convolution but just pass it through unmodified. 1 = The image<br />
only defines a luminance channel for convolution, an (optional) alpha<br />
channel is passed through unmodified. 4 = Use all four channels (Red,<br />
green, blue, alpha) for convolution.</p>
<p>‘nroutchannels’ = The number of channels to convolve as output: 3 =<br />
Convolve each of the three color channels red, green and blue separately<br />
by the same kernel. An (optional) alpha channel is passed through unmodified.<br />
1 = Output a filtered luminance channel, and an (optional) unmodified<br />
alpha channel. If input is a 3 channel RGB image, then the RGB image will<br />
get converted to luminance before convolution. 4 = Filter all four<br />
channels independently.</p>
<h3 id="typical-settings">Typical settings:</h3>
<p>Filter a RGB(A) image: nrinputchannels = 3, nroutchannels = 3.<br />
Filter a RGB(A) image into grayscale: nrinputchannels = 3, nroutchannels = 1.<br />
Filter a luminance(A) image: inputchannels = 1, filteredoutchannels = 1.<br />
Generic filtering of 4-channel data: nrinputchannels = 4, nroutchannels = 4.</p>
<p>‘debug’ Optional debug flag: If set to non-zero, will output some debug<br />
info about the shader.</p>
<p>‘shadertype’ (Optional) The type of internal implementation to choose for<br />
the operator. This parameter is best left alone, unless you really know<br />
what you are doing.</p>
<h3 id="caution">CAUTION:</h3>
<p>This feature is in early alpha stage. It may fail on your system and its<br />
future implementation may change significantly! Don’t trust its results<br />
without validation against a known good reference implementation!</p>
<p>NOTES: Filtermode 2 and 3 not fully implemented for the general case!<br />
—&gt; No separable 1D kernels, no support for all input-&gt;output mappings</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychOpenGL/PsychGLSLShaders/EXPCreateStatic2DConvolutionShader.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychOpenGL/PsychGLSLShaders/EXPCreateStatic2DConvolutionShader.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychOpenGL/PsychGLSLShaders/EXPCreateStatic2DConvolutionShader.m</code></p>
</div>
