<h2 id="psychtoolbox-psychcolorimetricdata">[[Psychtoolbox]] › [[PsychColorimetricData]]</h2>
<p>[T_quantalAbsorptionsNormalized,T_quantalAbsorptions,T_quantalIsomerizations,adjIndDiffParams] = <a href="ComputeRawConeFundamentals" class="uri">ComputeRawConeFundamentals</a>(params,staticParams)</p>
<p>Function to compute normalized cone quantal sensitivities from underlying<br />
pieces and parameters.</p>
<p>Note that this routine returns quantal sensitivities. You may want<br />
energy sensitivities. In that case, use <a href="EnergyToQuanta" class="uri">EnergyToQuanta</a> to convert<br />
T_energy = <a href="EnergyToQuanta" class="uri">EnergyToQuanta</a>(S,T_quantal’)’<br />
and then renormalize. (You call <a href="EnergyToQuanta" class="uri">EnergyToQuanta</a> because you’re converting<br />
sensitivities, which go the opposite direction from spectra.)</p>
<p>The routine also returns two types of quantal sensitivity functions. The<br />
first gives the probability that a photon will be absorbed. These are<br />
returned in variable T_quantalAbsorptionsNormalized and<br />
T_quantalAbsorptions, with the first being normalized. The second is the<br />
probability that the photon will cause a photopigment isomerization. This<br />
is returned in T_quantalIsomerizations.</p>
<p>It is T_quantalIsomerizations that you want to use to compute<br />
isomerization rates from retinal illuminance. See note at the end of<br />
function <a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a> for some information about conventions. In<br />
particular, this routine takes pre-retinal absorption into account in its<br />
computation of probability of absorptions and isomerizations, so that the<br />
relevant retinal illuminance is one computed without accounting for those<br />
factors. This routine does not account for light attenuation due to the<br />
pupil, however. The only use of pupil size here is becuase of its slight<br />
effect on lens density as accounted for in the CIE standard. Nor does it<br />
account for the collecting area of a photoreceptor, for cones the inner<br />
segment diameter.</p>
<p>In the passed params structure, you can either pass the lambdaMax values<br />
for the photopigment, in which case the absorbance is computed from the<br />
specified nomogram, or you can pass the absorbance values directly in<br />
T_xxx format. A typical choice in this case would be<br />
10.^T_log10coneabsorbance_ss for the Stockman-Sharpe/CIE estimates.</p>
<p>The typical use of this function is to be called by<br />
<a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a>, which sets up the passed structures acording<br />
to the CIE standard. This routine, however, could in principle be used<br />
with a wide variety of choices of the component pieces.</p>
<p>The other place this function is used is in attempts to fit a set of cone<br />
fundamentals by doing parameter search over the pieces. It is this<br />
second use that led to the parameters being split over two separate<br />
structures, one that is held static during the fit and the other which<br />
contains the parameters that could be searched over by a calling routine.<br />
For examples, see:<br />
<a href="FitConeFundamentalsWithNomogram" class="uri">FitConeFundamentalsWithNomogram</a>, <a href="FitConeFundamentalsTest" class="uri">FitConeFundamentalsTest</a>.<br />
Looking around today (8/10/13), I (DHB) don’t see any examples where this<br />
routine is called directly. Rather, it is a subfunction called by<br />
<a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a>. The search routines above use<br />
<a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a>, and only search over lambdaMax values. I<br />
think I wrote this with the thought that I might one day search over more<br />
parameters, but lost motivation to carry it throught.</p>
<p>The computations done here are very similar to those done in routine<br />
<a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a>. I (DHB) think that I forgot about what<br />
<a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a> could do when I wrote this, which has led to some<br />
redundancy. <a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a> returns a field called<br />
effectiveAbsorptance, which are the actual quantal efficiencies (not<br />
normalized) referred to the cornea. <a href="FillInPhotoceptors" class="uri">FillInPhotoceptors</a> also computes a<br />
field isomerizationAbsorptance, which takes the quantal efficiency of<br />
isomerizations (probability of an isomerization given an absorption into<br />
acount.</p>
<p>It would probably be clever to unify the two sets of routines a little<br />
more, but we may never get to it. The routine <a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a><br />
does contain a check that this routine and what is returned by<br />
<a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a> agree with each other, for cases where the<br />
parameters match.</p>
<p>See <a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a> for the breakdown of how the Asano et al.<br />
(2016) individual differences model is specified in params.indDiffParams.</p>
<p>See <a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a> for documentation of the adjIndDiffParams<br />
output argument.</p>
<p>See also: <a href="ComputeCIEConeFundamentals" class="uri">ComputeCIEConeFundamentals</a>, <a href="CIEConeFundamentalsTest" class="uri">CIEConeFundamentalsTest</a>,<br />
<a href="FitConeFundamentalsWithNomogram" class="uri">FitConeFundamentalsWithNomogram</a>,<br />
<a href="FitConeFundamentalsTest" class="uri">FitConeFundamentalsTest</a>, <a href="DefaultPhotoreceptors" class="uri">DefaultPhotoreceptors</a>,<br />
<a href="FillInPhotoreceptors" class="uri">FillInPhotoreceptors</a>.</p>
<p>8/12/11 dhb Starting to make this actually work.<br />
8/14/11 dhb Change name, expand comments.<br />
8/10/13 dhb <a href="Expand" class="uri">Expand</a> comments. Return unscaled quantal efficiencies too.<br />
2/26/16 dhb, ms Add in Asano et al. (2016) individual observer adjustments<br />
3/30/17 ms Added output argument returning adjusted ind differences<br />
6/4/18 ms Included absorbance spectrum into adjusted ind diff output arg</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychColorimetricData/ComputeRawConeFundamentals.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychColorimetricData/ComputeRawConeFundamentals.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychColorimetricData/ComputeRawConeFundamentals.m</code></p>
</div>
