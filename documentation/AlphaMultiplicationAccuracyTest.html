<h2 id="psychtoolbox-psychtests">[[Psychtoolbox]] › [[PsychTests]]</h2>
<p>[maximumError, roundTypeStr, independentFlag]=<a href="AlphaMultiplicationAccuracyTest" class="uri">AlphaMultiplicationAccuracyTest</a>([screenNumber])</p>
<p>Test the accuracy of alpha blending multiplication. <a href="OpenGL" class="uri">OpenGL</a> guarantees<br />
perfect accuracy of alpha multiplication for values 0 and 1 only.<br />
<a href="AlphaMultiplicationAccuracyTest" class="uri">AlphaMultiplicationAccuracyTest</a> measures accuracy of intermediate values.</p>
<p>Return argument “maximumError” is the maximum unsigned difference between<br />
<a href="OpenGL" class="uri">OpenGL</a> alpha multiplication and simulated alpha blending in MATLAB using<br />
double-precisions floating point multiplication.</p>
<h3 id="values-of-maximumerror-fall-into-three-categories">Values of maximumError fall into three categories:</h3>
<p>0 &lt;= maximumError &lt; 0.5 : <a href="OpenGL" class="uri">OpenGL</a> rounds to nearest integer. No<br />
accuracy loss for a single multiplication.</p>
<p>0.5 &lt;= maximumError &lt; 1 : <a href="OpenGL" class="uri">OpenGL</a> truncates or rounds up. For a single<br />
multiplication, Accuracy is off 0.5 parts<br />
in 255 more than would multiplying luminances<br />
using floating-point values and rounding.</p>
<p>maximumError &gt;= 1 : Something is wrong.</p>
<p><a href="AlphaMultiplicationAccuracyTest" class="uri">AlphaMultiplicationAccuracyTest</a> tries to determine whether <a href="OpenGL" class="uri">OpenGL</a> alpha<br />
multiplication rounds to the nearest integer, rounds down or rounds up<br />
and returns in “roundTypeStr” a string indicating which, either, “round”<br />
“floor”, or “ceil”. If <a href="AlphaMultiplicationAccuracyTest" class="uri">AlphaMultiplicationAccuracyTest</a> can not determine<br />
the rounding method, then it returns “unknown”.</p>
<p><a href="AlphaMultiplicationAccuracyTest" class="uri">AlphaMultiplicationAccuracyTest</a> also tests that multiplication errors are<br />
independent of the choice of blending factor string and the blending<br />
surface, setting return argument “independentFlag” accordingly.</p>
<p>Because in <a href="OpenGL" class="uri">OpenGL</a> pixel color components are ultimately encoded as 8-bit<br />
integers in video RAM, the results of <a href="OpenGL" class="uri">OpenGL</a> alpha multiplicaion will be<br />
less accurate than those predicted by floating-point calculations. If<br />
<a href="OpenGL" class="uri">OpenGL</a> rounds to the nearest integer then the alpha multiply error will<br />
be less than 0.5. This is the limit of precision of the color components<br />
of a pixel. Therefore, when alpha blending rounds to the nearest integer,<br />
no more accuracy is lost with <a href="OpenGL" class="uri">OpenGL</a> alpha blending than by calculating<br />
pixel values in MATLAB with floating point precision then rounding them<br />
to integer pixel values for display.</p>
<p>Note that errors are cumulative and iterative alpha multiplication, in<br />
which a product of a prevoius multiplication becomes a factor in a<br />
subsequent multiplication, can produce large errors, even in the best<br />
case of rounding where 0 &lt;= maximumError &lt; 0.5. Note also that A single<br />
alpha blending operation may result in two multipliations, because both<br />
source and destination surfaces may be multiplied before they are added.</p>
<p>We test blending accuracy becasue <a href="OpenGL" class="uri">OpenGL</a> makes no gurantees. The <a href="OpenGL" class="uri">OpenGL</a><br />
policy on alpha multiplician is summarized here:</p>
<p>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/opengl/glfunc01_4vs3.asp</p>
<pre><code>    &quot;Despite the apparent precision of the above equations, blending  
    arithmetic is not exactly specified, because blending operates with  
    imprecise integer color values. However, a blend factor that should be  
    equal to one is guaranteed not to modify its multiplicand, and a blend  
    factor equal to zero reduces its multiplicand to zero.&quot;   </code></pre>
<p>See also: <a href="AlphaBlendingTest" class="uri">AlphaBlendingTest</a>, <a href="PsychAlphaBlending" class="uri">PsychAlphaBlending</a></p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychTests/AlphaMultiplicationAccuracyTest.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychTests/AlphaMultiplicationAccuracyTest.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychTests/AlphaMultiplicationAccuracyTest.m</code></p>
</div>
