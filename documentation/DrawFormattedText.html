<h2 id="psychtoolbox-psychbasic">[[Psychtoolbox]] › [[PsychBasic]]</h2>
<p>[nx, ny, textbounds, wordbounds] = <a href="DrawFormattedText" class="uri">DrawFormattedText</a>(win, tstring [, sx][, sy][, color][, wrapat][, flipHorizontal][, flipVertical][, vSpacing][, righttoleft][, winRect])</p>
<p>Draws a string of text ‘tstring’ into Psychtoolbox window ‘win’. Allows<br />
some basic formatting.</p>
<p>Please note that all formatting of text and returned information about<br />
the bounding box of the text is only approximative and may be inaccurate<br />
for some text strings, fonts, font settings and combination of parameters<br />
for this function. Centering of text and bounding box calculations work<br />
best for single line text, vertical centering may be a bit off for multi-<br />
line text.</p>
<p>The text string ‘tstring’ may contain newline characters ‘’.<br />
Whenever a newline character ‘’ is encountered, a linefeed and<br />
carriage return is performed, breaking the text string into lines.</p>
<p>‘sx’ defines the left border of the text: If it is left out, text<br />
starts at x-position zero, otherwise it starts at the specified position<br />
‘sx’. If sx==‘center’, then each line of text is horizontally centered in<br />
the window. If sx==‘right’, then each line of text is right justified to<br />
the right border of the target window, or of ‘winRect’, if provided.<br />
The options sx == ‘wrapat’ and sx == ‘justifytomax’ try to align the start<br />
of each text line to the left border and the end of each text line to either<br />
the specified ‘wrapat’ number of columns, or to the width of the widest line<br />
of text in the text string, causing all lines of text to appear of roughly<br />
even width. This is achieved by adjusting the width of blanks between words<br />
in each line of text to even out text line length. The sx == ‘wrapat’ and<br />
sx == ‘justifytomax’ options are considered experimental. They only work for<br />
non-flipped, simple text, and even there they may work badly, so don’t rely on<br />
them doing the right thing without assistance of your code, e.g., breaking<br />
text into lines of reasonably similar length. The justification functions<br />
will not justify text which deviates by more than ptb_drawformattedtext_padthresh<br />
from the target width of the text, with ptb_drawformattedtext_padthresh being<br />
a global variable you can set. It defaults to 0.333 ie., doesn’t justify text<br />
lines if the text lines are more than 33% shorter than the reference line.<br />
If sx==‘centerblock’ then text is not horizontally centered individually for<br />
each line of text, as with ‘center’, but for multi-line text, the whole block<br />
of text is roughly centered, by starting all lines left-justified, but then shifting<br />
this whole block of left justified text horizontally so that the longest line<br />
in the block of text is horizontally centered in the target window or ‘winRect’.</p>
<p>‘sy’ defines the baseline of the (first line of the) text. If left out, text starts<br />
roughly at the top of the window, otherwise it starts at the specified vertical<br />
pixel position.</p>
<p>If sy==‘center’, then the whole text is roughly vertically centered in the<br />
window. ‘color’ is the color value of the text (color index or [r g b]<br />
triplet or [r g b a] quadruple). If color is left out, the current text<br />
color from previous text drawing commands is used. ‘wrapat’, if provided,<br />
will automatically break text strings longer than ‘wrapat’ characters<br />
into newline separated strings of roughly ‘wrapat’ characters. This is<br />
done by calling the <a href="WrapString" class="uri">WrapString</a> function (See ‘help WrapString’). ‘wrapat’<br />
mode may not work reliably with non-ASCII text strings, e.g., UTF-8<br />
encoded uint8 strings on all systems.</p>
<p>The optional flag ‘flipHorizontal’ if set to 1 will mirror the text<br />
horizontally, whereas the optional flag ‘flipVertical’ if set to 1 will<br />
mirror the text vertically (upside down).</p>
<p>The optional argument ‘vSpacing’ sets the spacing between the lines. Default<br />
value is 1.</p>
<p>The optional argument ‘righttoleft’ if set to 1, will ask to draw the<br />
text string in right-to-left reading direction, e.g., for scripts which<br />
read right to left</p>
<p>The optional argument ‘winRect’ allows to specify a [left top right bottom]<br />
rectange, in which the text should be centered/placed etc. By default,<br />
the rectangle of the whole ’win’dow is used.</p>
<p>The function employs clipping by default. Text lines that are detected as<br />
lying completely outside the ‘win’dow or optional ’winRect’ will not be<br />
drawn, but clipped away. This allows to draw multi-page text (multiple<br />
screen heights) without too much loss of drawing speed. If you find the<br />
clipping to interfere with text layout of exotic texts/fonts at exotic<br />
sizes and formatting, you can define the global variable…</p>
<p>global ptb_drawformattedtext_disableClipping;<br />
… and set it like this …<br />
ptb_drawformattedtext_disableClipping = 1;<br />
… to disable the clipping.</p>
<p>Clipping also gets disabled if you request the optional 3rd return<br />
parameter ‘textbounds’ to ensure correct computation of a bounding box<br />
that covers the complete text. You can enforce clipping by setting<br />
ptb_drawformattedtext_disableClipping = -1; however, computed bounding<br />
boxes will then only describe the currently visible (non-clipped) text.</p>
<p>The function returns the new (nx, ny) position of the text drawing cursor<br />
and the bounding rectangle ‘textbounds’ of the drawn string. (nx,ny) can<br />
be used as new start position for connecting further text strings to the<br />
bottom of the drawn text string. Calculation of these bounds is<br />
approximative, so it may give wrong results with some text fonts and<br />
styles on some operating systems, depending on the various settings.</p>
<p>The optional return argument ‘wordbounds’, if assigned in the calling<br />
function, returns a n-by-4 matrix of per-word bounding boxes. Each row<br />
defines a [left,top,right,bottom] rectangle with the bounding box of a<br />
word in the text string, ie. row 1 = first word, row 2 = 2nd word, …<br />
white-space characters delimit single words and are not taken into<br />
account, the successive words are defined by the function strtok(tstring).<br />
Per word bounding boxes don’t work if flipHorizontal or flipVertical is<br />
requested.</p>
<p>See <a href="DrawFormattedTextDemo" class="uri">DrawFormattedTextDemo</a> for a usage example.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychBasic/DrawFormattedText.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychBasic/DrawFormattedText.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychBasic/DrawFormattedText.m</code></p>
</div>
