<h2 id="psychtoolbox-psychglimageprocessing">[[Psychtoolbox]] › [[PsychGLImageProcessing]]</h2>
<p>remapCLUTId = <a href="PsychHelperCreateRGB111110RemapCLUTAMDDCE8" class="uri">PsychHelperCreateRGB111110RemapCLUTAMDDCE8</a>;</p>
<p>Helper function for Psychtoolbox imaging pipeline, called by<br />
<a href="PsychImaging" class="uri">PsychImaging</a>(), not meant to be called by normal user code!</p>
<p>Build a 3 rows by 2048 texels RGBA8 lookup texture for mapping HDR RGB<br />
pixel values in range 0-2047 (ie. 11 bpc resolution) to RGBA8 framebuffer<br />
pixels which will be suitable to drive a BGR10-10-11 framebuffer scanout<br />
engine (CRTC). If a graphics cards framebuffer scanout engine CRTC is<br />
configured for 10-11-11 ~ 11 bpc framebuffer mode, this will make sure that<br />
HDR pixel data is shown properly onscreen.</p>
<p>This texture is used as CLUT texture for the<br />
<a href="RGBMultiLUTLookupCombine" class="uri">RGBMultiLUTLookupCombine</a>_FormattingShader.frag.txt in the final output<br />
formatting chain of the imaging pipeline.</p>
<p>The expected pixel layout in 11bpc mode is: BGR101111, ie.:<br />
R11 G11 B10 – That’s how a 32 bit pixel is interpreted for video<br />
scanout. However the <a href="OpenGL" class="uri">OpenGL</a> system on all current OS with standard<br />
drivers can only output A8R8G8B8 formatted pixels. We solve this via the<br />
imaging pipeline: <a href="Screen" class="uri">Screen</a>() and <a href="OpenGL" class="uri">OpenGL</a> drawing ops go to the imaging<br />
pipelines virtual framebuffer with 16bpc float or 32 bpc float precision.<br />
At <a href="Flip" class="uri">Flip</a> time, our shader remaps that 0.0 - 1.0 values to the range 0-2047<br />
ie. approx. 11 bpc, then uses the CLUT texture created with this function to<br />
lookup corresponding ARGB8 color tuples for the framebuffer, combines<br />
them into a single ARGB8 tuple by addition (logical OR), then writes that<br />
ARGB tuple to the framebuffer. At display scanout time, the CRTC’s will<br />
find 32 bit pixels properly formatted for BGR101111 scanout.</p>
<p>This requires a suitable graphics cards with an at least 11 bpc capable<br />
display pipeline. This is the case for recent AMD gpu’s of the “Sea Islands”<br />
and “Volcanic Islands” family with a DCE-8 or later display engine. Those are<br />
said to have full 12 bpc pipelines.</p>
<p>History:<br />
8-Jun-2014 Written - Derived from <a href="PsychHelperCreateARGB2101010RemapCLUT" class="uri">PsychHelperCreateARGB2101010RemapCLUT</a>.m (MK).<br />
25-May-2016 Fixed up for DCE-10 “Volcanic Islands” Radeon R9 380 Tonga Pro (MK).<br />
Turns out they need very different formatting and our original<br />
implementation on non-12 bpc capable gpu’s caused wrong test results.</p>
<div class="code_header" style="text-align:right;">
<p><span style="float:left;">Path  </span> <span class="counter">Retrieve <a href=
  "https://raw.github.com/Psychtoolbox-3/Psychtoolbox-3/beta/Psychtoolbox/PsychGLImageProcessing/PsychHelperCreateRGB111110RemapCLUTAMDDCE8.m">current version from GitHub</a> | View <a href=
  "https://github.com/Psychtoolbox-3/Psychtoolbox-3/commits/beta/Psychtoolbox/PsychGLImageProcessing/PsychHelperCreateRGB111110RemapCLUTAMDDCE8.m">changelog</a></span></p>
</div>
<div class="code">
<p><code>Psychtoolbox/PsychGLImageProcessing/PsychHelperCreateRGB111110RemapCLUTAMDDCE8.m</code></p>
</div>
